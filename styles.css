/* ============================================
   Quizlet Design System - Font Face Declarations
   ============================================ */
@font-face {
    font-family: 'Hurme Geometric Sans 2';
    src: url('fonts/HurmeGeometricSans2-Regular.otf') format('opentype');
    font-weight: 400;
    font-style: normal;
    font-display: swap;
}

@font-face {
    font-family: 'Hurme Geometric Sans 2';
    src: url('fonts/HurmeGeometricSans2-Italic.otf') format('opentype');
    font-weight: 400;
    font-style: italic;
    font-display: swap;
}

@font-face {
    font-family: 'Hurme Geometric Sans 2';
    src: url('fonts/HurmeGeometricSans2-SemiBold.otf') format('opentype');
    font-weight: 600;
    font-style: normal;
    font-display: swap;
}

@font-face {
    font-family: 'Hurme Geometric Sans 2';
    src: url('fonts/HurmeGeometricSans2-SemiBoldItalic.otf') format('opentype');
    font-weight: 600;
    font-style: italic;
    font-display: swap;
}

@font-face {
    font-family: 'Hurme Geometric Sans 2';
    src: url('fonts/HurmeGeometricSans2-Bold.otf') format('opentype');
    font-weight: 700;
    font-style: normal;
    font-display: swap;
}

@font-face {
    font-family: 'Hurme Geometric Sans 2';
    src: url('fonts/HurmeGeometricSans2-BoldItalic.otf') format('opentype');
    font-weight: 700;
    font-style: italic;
    font-display: swap;
}

/* ============================================
   CSS Variables - Quizlet Design System Tokens
   ============================================ */

/* ----------------------------------------
   Reference Tokens (Primitives)
   ---------------------------------------- */
:root {
    /* Gray Scale */
    --ref-color-gray-100: #FFFFFF;
    --ref-color-gray-100-none: #FFFFFF00;
    --ref-color-gray-200: #F6F7FB;
    --ref-color-gray-300: #EDEFF4;
    --ref-color-gray-400: #D9DDE8;
    --ref-color-gray-500: #939BB4;
    --ref-color-gray-600: #586380;
    --ref-color-gray-700: #2E3856;
    --ref-color-gray-800: #282E3E;
    --ref-color-gray-900: #1A1D28;
    --ref-color-gray-exception-100-a8: #FFFFFF14;
    --ref-color-gray-exception-100-a32: #FFFFFF52;
    --ref-color-gray-exception-600-a0: #58638000;
    --ref-color-gray-exception-600-a8: #58638014;
    --ref-color-gray-exception-600-a12: #5863801F;
    --ref-color-gray-exception-750: #202040;
    
    /* Twilight (Primary Brand) */
    --ref-color-twilight-100: #EDEFFF;
    --ref-color-twilight-200: #DBDFFF;
    --ref-color-twilight-300: #A8B1FF;
    --ref-color-twilight-400: #7583FF;
    --ref-color-twilight-500: #4255FF;
    --ref-color-twilight-600: #423ED8;
    --ref-color-twilight-700: #1F1C8B;
    --ref-color-twilight-800: #14125C;
    --ref-color-twilight-900: #0A092D;
    --ref-color-twilight-900-none: #0A092D00;
    
    /* Sunset (Upgrade/Premium) */
    --ref-color-sunset-100: #FFF9E3;
    --ref-color-sunset-200: #FFEDAB;
    --ref-color-sunset-300: #FFDC62;
    --ref-color-sunset-400: #FFCD1F;
    --ref-color-sunset-500: #997700;
    
    /* Mint (Success) */
    --ref-color-mint-100: #E6FCF4;
    --ref-color-mint-200: #C7F7E6;
    --ref-color-mint-300: #98F1D1;
    --ref-color-mint-400: #59E8B5;
    --ref-color-mint-500: #18AE79;
    --ref-color-mint-600: #12815A;
    
    /* Lilac */
    --ref-color-lilac-100: #FCF0FF;
    --ref-color-lilac-200: #F7D9FF;
    --ref-color-lilac-300: #EEAAFF;
    --ref-color-lilac-400: #E372FF;
    --ref-color-lilac-500: #9900BE;
    
    /* Sky Blue */
    --ref-color-skyblue-100: #EAF9FF;
    --ref-color-skyblue-200: #CBF1FF;
    --ref-color-skyblue-300: #98E3FF;
    --ref-color-skyblue-400: #51CFFF;
    --ref-color-skyblue-500: #008EC4;
    
    /* Lemon */
    --ref-color-lemon-100: #FDFFE9;
    --ref-color-lemon-200: #FAFFBB;
    --ref-color-lemon-300: #F5FF7D;
    --ref-color-lemon-400: #EBFF03;
    --ref-color-lemon-500: #D4E603;
    
    /* Sherbert (Warning) */
    --ref-color-sherbert-100: #FFF6EF;
    --ref-color-sherbert-200: #FFE8D8;
    --ref-color-sherbert-300: #FFC38C;
    --ref-color-sherbert-400: #FF983A;
    --ref-color-sherbert-500: #CC4E00;
    
    /* Cherry (Error/Danger) */
    --ref-color-cherry-300: #FF7873;
    --ref-color-cherry-400: #DA4543;
    --ref-color-cherry-500: #B00020;
    
    /* Scrim (Overlays) */
    --ref-color-scrim-100: #0A092D14;
    --ref-color-scrim-200: #2E385680;
    --ref-color-scrim-300: #0101108F;
    
    /* Other/Accent Colors */
    --ref-color-cucumber: #D9FFCC;
    --ref-color-dandelion: #ECE381;
    --ref-color-grape-400: #A157E9;
    --ref-color-grape-500: #A533FF;
    --ref-color-grape-600: #932EE8;
    --ref-color-jam: #D326D7;
    --ref-color-magenta-400: #F442A0;
    --ref-color-magenta-500: #D62381;
    --ref-color-navy: #002C6D;
    --ref-color-pale-ice: #CCF9FF;
    --ref-color-periwinkle: #A0C4FA;
    --ref-color-plum: #5E0F5B;
    --ref-color-ruby: #F6406C;
    --ref-color-rosewater: #FDD2CA;
    --ref-color-sea-green: #009AA4;
    --ref-color-sea-spray: #D3F0EB;
    --ref-color-shadow: #282E3E1A;
    --ref-color-none: #00000000;
    
    /* Spacing */
    --ref-spacing-none: 0px;
    --ref-spacing-xxsmall: 4px;
    --ref-spacing-xsmall: 8px;
    --ref-spacing-small: 16px;
    --ref-spacing-medium: 24px;
    --ref-spacing-large: 32px;
    --ref-spacing-xlarge: 48px;
    --ref-spacing-xxlarge: 64px;
    --ref-spacing-exception-2: 2px;
    --ref-spacing-exception-6: 6px;
    --ref-spacing-exception-10: 10px;
    --ref-spacing-exception-12: 12px;
    --ref-spacing-exception-20: 20px;
    
    /* Stroke */
    --ref-stroke-thin: 1px;
    --ref-stroke-regular: 2px;
    
    /* Size */
    --ref-size-none: 0px;
    --ref-size-small: 16px;
    --ref-size-medium: 24px;
    --ref-size-large: 32px;
    --ref-size-xlarge: 48px;
    --ref-size-xxlarge: 64px;
    --ref-size-xxxlarge: 88px;
    
    /* Radius */
    --ref-radius-none: 0px;
    --ref-radius-small: 4px;
    --ref-radius-medium: 8px;
    --ref-radius-large: 16px;
    --ref-radius-xlarge: 24px;
    --ref-radius-xxlarge: 32px;
    --ref-radius-xxxlarge: 48px;
    --ref-radius-full: 200px;
    
    /* Shadow Values */
    --ref-shadow-spread-none: 0px;
    --ref-shadow-offset-none: 0px;
    --ref-shadow-offset-small: 2px;
    --ref-shadow-offset-medium: 4px;
    --ref-shadow-blur-small: 4px;
    --ref-shadow-blur-medium: 16px;
    --ref-shadow-blur-large: 32px;
    
    /* Typography */
    --ref-typography-font-family: 'Hurme Geometric Sans 2';
    --ref-typography-weight-header: 700;
    --ref-typography-weight-subheader: 600;
    --ref-typography-weight-body: 400;
    --ref-typography-letter-spacing-none: 0;
    
    /* Header Sizes */
    --ref-typography-size-header-one: 44px;
    --ref-typography-line-height-header-one: 56px;
    --ref-typography-size-header-two: 32px;
    --ref-typography-line-height-header-two: 40px;
    --ref-typography-size-header-three: 24px;
    --ref-typography-line-height-header-three: 32px;
    --ref-typography-size-header-four: 20px;
    --ref-typography-line-height-header-four: 28px;
    --ref-typography-size-header-five: 16px;
    --ref-typography-line-height-header-five: 24px;
    
    /* Subheading Sizes */
    --ref-typography-size-subheading-one: 24px;
    --ref-typography-line-height-subheading-one: 36px;
    --ref-typography-size-subheading-two: 20px;
    --ref-typography-line-height-subheading-two: 28px;
    --ref-typography-size-subheading-three: 16px;
    --ref-typography-line-height-subheading-three: 24px;
    --ref-typography-size-subheading-four: 14px;
    --ref-typography-line-height-subheading-four: 20px;
    --ref-typography-size-subheading-five: 12px;
    --ref-typography-line-height-subheading-five: 16px;
    
    /* Body Sizes */
    --ref-typography-size-body-one: 24px;
    --ref-typography-line-height-body-one: 32px;
    --ref-typography-size-body-two: 20px;
    --ref-typography-line-height-body-two: 28px;
    --ref-typography-size-body-three: 16px;
    --ref-typography-line-height-body-three: 24px;
    --ref-typography-size-body-four: 14px;
    --ref-typography-line-height-body-four: 20px;
    --ref-typography-size-body-five: 12px;
    --ref-typography-line-height-body-five: 16px;
    
    /* Animation Easings */
    --ref-anim-ease-enter: cubic-bezier(0.30, 0.00, 0.44, 1.00);
    --ref-anim-ease-enter-spring: cubic-bezier(0.35, 1.40, 0.25, 1.00);
    --ref-anim-ease-exit: cubic-bezier(0.49, 0.00, 0.68, 1.00);
    --ref-anim-ease-exit-spring: cubic-bezier(0.40, 0.00, 0.60, -0.40);
    --ref-anim-ease-persist: cubic-bezier(0.37, 0.00, 0.53, 1.00);
    --ref-anim-ease-persist-spring: cubic-bezier(0.35, 1.40, 0.25, 1.00);
    --ref-anim-ease-fade: cubic-bezier(0.35, 0.00, 0.50, 1.00);
}

/* ----------------------------------------
   System Tokens (Light Mode - Default)
   ---------------------------------------- */
:root {
    /* Surfaces */
    --sys-surface-base: var(--ref-color-gray-100);
    --sys-surface-base-none: var(--ref-color-gray-100-none);
    --sys-surface-raised: var(--ref-color-gray-100);
    --sys-surface-raised-transparent: var(--ref-color-gray-100);
    --sys-surface-inverse: var(--ref-color-gray-900);
    --sys-surface-status-upgrade: var(--ref-color-sunset-400);
    
    /* Overlay */
    --sys-overlay-primary: var(--ref-color-scrim-300);
    
    /* Text */
    --sys-text-primary: var(--ref-color-gray-800);
    --sys-text-secondary: var(--ref-color-gray-600);
    --sys-text-inverse: var(--ref-color-gray-200);
    --sys-text-highlight: var(--ref-color-twilight-500);
    --sys-text-status-success: var(--ref-color-mint-600);
    --sys-text-status-warning: var(--ref-color-sherbert-500);
    --sys-text-status-error: var(--ref-color-cherry-500);
    
    /* Border */
    --sys-border-primary: var(--ref-color-gray-300);
    --sys-border-transparent: var(--ref-color-gray-100-none);
    --sys-border-status-success: var(--ref-color-mint-600);
    --sys-border-status-warning: var(--ref-color-sherbert-400);
    --sys-border-status-error: var(--ref-color-cherry-500);
    
    /* Interactive - Background - Primary */
    --sys-interactive-bg-primary-default: var(--ref-color-twilight-500);
    --sys-interactive-bg-primary-hover: var(--ref-color-twilight-600);
    --sys-interactive-bg-primary-focus: var(--ref-color-twilight-500);
    --sys-interactive-bg-primary-press: var(--ref-color-twilight-700);
    --sys-interactive-bg-primary-disabled: var(--ref-color-gray-200);
    
    /* Interactive - Background - Secondary */
    --sys-interactive-bg-secondary-default: var(--ref-color-twilight-100);
    --sys-interactive-bg-secondary-hover: var(--ref-color-twilight-200);
    --sys-interactive-bg-secondary-focus: var(--ref-color-twilight-100);
    --sys-interactive-bg-secondary-press: var(--ref-color-twilight-300);
    --sys-interactive-bg-secondary-disabled: var(--ref-color-gray-200);
    --sys-interactive-bg-secondary-selected: var(--ref-color-twilight-100);
    
    /* Interactive - Background - Tertiary */
    --sys-interactive-bg-tertiary-default: var(--ref-color-gray-200);
    --sys-interactive-bg-tertiary-hover: var(--ref-color-gray-300);
    --sys-interactive-bg-tertiary-focus: var(--ref-color-gray-200);
    --sys-interactive-bg-tertiary-press: var(--ref-color-gray-400);
    --sys-interactive-bg-tertiary-disabled: var(--ref-color-gray-200);
    --sys-interactive-bg-tertiary-selected: var(--ref-color-gray-200);
    
    /* Interactive - Background - Status */
    --sys-interactive-bg-status-upgrade-default: var(--ref-color-sunset-400);
    --sys-interactive-bg-status-upgrade-hover: var(--ref-color-sunset-300);
    --sys-interactive-bg-status-upgrade-focus: var(--ref-color-sunset-400);
    --sys-interactive-bg-status-upgrade-press: var(--ref-color-sunset-200);
    --sys-interactive-bg-status-upgrade-disabled: var(--ref-color-gray-200);
    --sys-interactive-bg-status-danger-default: var(--ref-color-cherry-500);
    --sys-interactive-bg-status-danger-hover: var(--ref-color-cherry-400);
    --sys-interactive-bg-status-danger-focus: var(--ref-color-cherry-500);
    --sys-interactive-bg-status-danger-press: var(--ref-color-cherry-300);
    --sys-interactive-bg-status-danger-disabled: var(--ref-color-gray-200);
    
    /* Interactive - Foreground - Primary */
    --sys-interactive-fg-primary-default: var(--ref-color-gray-100);
    --sys-interactive-fg-primary-hover: var(--ref-color-gray-100);
    --sys-interactive-fg-primary-focus: var(--ref-color-gray-100);
    --sys-interactive-fg-primary-press: var(--ref-color-gray-100);
    --sys-interactive-fg-primary-disabled: var(--ref-color-gray-400);
    
    /* Interactive - Foreground - Secondary */
    --sys-interactive-fg-secondary-default: var(--ref-color-twilight-500);
    --sys-interactive-fg-secondary-hover: var(--ref-color-twilight-600);
    --sys-interactive-fg-secondary-focus: var(--ref-color-twilight-500);
    --sys-interactive-fg-secondary-press: var(--ref-color-twilight-700);
    --sys-interactive-fg-secondary-disabled: var(--ref-color-gray-400);
    --sys-interactive-fg-secondary-selected: var(--ref-color-twilight-500);
    
    /* Interactive - Foreground - Tertiary */
    --sys-interactive-fg-tertiary-default: var(--ref-color-gray-600);
    --sys-interactive-fg-tertiary-hover: var(--ref-color-gray-600);
    --sys-interactive-fg-tertiary-focus: var(--ref-color-gray-600);
    --sys-interactive-fg-tertiary-press: var(--ref-color-gray-600);
    --sys-interactive-fg-tertiary-disabled: var(--ref-color-gray-400);
    --sys-interactive-fg-tertiary-selected: var(--ref-color-gray-600);
    
    /* Interactive - Foreground - Status */
    --sys-interactive-fg-status-upgrade-default: var(--ref-color-gray-800);
    --sys-interactive-fg-status-upgrade-disabled: var(--ref-color-gray-400);
    --sys-interactive-fg-status-danger-default: var(--ref-color-gray-100);
    --sys-interactive-fg-status-danger-disabled: var(--ref-color-gray-400);
    
    /* Interactive - Text Button - Background */
    --sys-interactive-text-bg-primary-default: var(--ref-color-none);
    --sys-interactive-text-bg-primary-hover: var(--ref-color-twilight-100);
    --sys-interactive-text-bg-primary-focus: var(--ref-color-none);
    --sys-interactive-text-bg-primary-press: var(--ref-color-twilight-200);
    --sys-interactive-text-bg-secondary-default: var(--ref-color-none);
    --sys-interactive-text-bg-secondary-hover: var(--ref-color-gray-300);
    --sys-interactive-text-bg-secondary-focus: var(--ref-color-none);
    --sys-interactive-text-bg-secondary-press: var(--ref-color-gray-400);
    
    /* Interactive - Text Button - Foreground */
    --sys-interactive-text-fg-primary-default: var(--ref-color-twilight-500);
    --sys-interactive-text-fg-primary-hover: var(--ref-color-twilight-600);
    --sys-interactive-text-fg-primary-focus: var(--ref-color-twilight-500);
    --sys-interactive-text-fg-primary-press: var(--ref-color-twilight-700);
    --sys-interactive-text-fg-primary-visited: var(--ref-color-twilight-400);
    --sys-interactive-text-fg-primary-disabled: var(--ref-color-gray-400);
    --sys-interactive-text-fg-secondary-default: var(--ref-color-gray-600);
    --sys-interactive-text-fg-secondary-hover: var(--ref-color-gray-700);
    --sys-interactive-text-fg-secondary-focus: var(--ref-color-gray-600);
    --sys-interactive-text-fg-secondary-press: var(--ref-color-gray-900);
    --sys-interactive-text-fg-secondary-visited: var(--ref-color-gray-500);
    --sys-interactive-text-fg-secondary-disabled: var(--ref-color-gray-400);
    --sys-interactive-text-fg-status-danger-default: var(--ref-color-cherry-500);
    --sys-interactive-text-fg-status-danger-disabled: var(--ref-color-gray-400);
    
    /* Interactive - Border */
    --sys-interactive-border-primary-default: var(--ref-color-gray-600);
    --sys-interactive-border-primary-focus: var(--ref-color-twilight-300);
    --sys-interactive-border-primary-selected: var(--ref-color-twilight-400);
    --sys-interactive-border-primary-disabled: var(--ref-color-gray-400);
    --sys-interactive-border-secondary-selected: var(--ref-color-gray-600);
}

/* ----------------------------------------
   Component Tokens (Light Mode)
   ---------------------------------------- */
:root {
    /* Input */
    --comp-input-bg-default: var(--ref-color-gray-200);
    --comp-input-text-placeholder: var(--ref-color-gray-500);
    --comp-input-text-disabled: var(--ref-color-gray-400);
    --comp-input-border-focus: var(--ref-color-twilight-300);
    
    /* Content List Item */
    --comp-content-list-item-bg-active: var(--sys-surface-base);
    --comp-content-list-item-bg-hover: var(--ref-color-gray-200);
    --comp-content-list-item-bg-focus: var(--sys-surface-base);
    --comp-content-list-item-bg-press: var(--ref-color-gray-300);
    
    /* Pills */
    --comp-pills-bg-metadata-primary: var(--ref-color-gray-900);
    --comp-pills-bg-metadata-secondary: var(--ref-color-twilight-100);
    --comp-pills-bg-callout-primary: var(--ref-color-skyblue-400);
    --comp-pills-bg-status-subtle: var(--ref-color-gray-400);
    --comp-pills-bg-status-upgrade: var(--sys-surface-status-upgrade);
    --comp-pills-bg-status-verified: var(--ref-color-mint-200);
    --comp-pills-fg-metadata-primary: var(--ref-color-gray-200);
    --comp-pills-fg-metadata-secondary: var(--ref-color-gray-700);
    --comp-pills-fg-callout-primary: var(--ref-color-gray-700);
    --comp-pills-fg-status-subtle: var(--ref-color-gray-700);
    --comp-pills-fg-status-upgrade: var(--ref-color-gray-700);
    --comp-pills-fg-status-verified: var(--ref-color-gray-700);
    
    /* Progress Bar */
    --comp-progress-bar-bg-empty: var(--ref-color-gray-300);
    --comp-progress-bar-bg-primary: var(--ref-color-twilight-400);
    --comp-progress-bar-bg-secondary: var(--ref-color-skyblue-400);
    --comp-progress-bar-bg-known: var(--ref-color-mint-500);
    --comp-progress-bar-bg-unknown: var(--ref-color-sherbert-400);
    --comp-progress-bar-bg-puck-known: var(--ref-color-mint-600);
    --comp-progress-bar-fg-puck-known: var(--ref-color-gray-100);
    
    /* Page Indicator */
    --comp-page-indicator-bg-active: var(--ref-color-twilight-600);
    --comp-page-indicator-bg-inactive: #58638029;
    
    /* Shimmer */
    --comp-shimmer-bg-solid: var(--ref-color-gray-exception-600-a8);
    --comp-shimmer-bg-gradient-edge: var(--ref-color-gray-exception-600-a0);
    --comp-shimmer-bg-gradient-center: var(--ref-color-gray-exception-600-a12);
    
    /* Study Mode Button */
    --comp-study-mode-btn-bg-default: var(--ref-color-gray-200);
    --comp-study-mode-btn-bg-pressed: var(--ref-color-gray-300);
    --comp-study-mode-btn-fg-default: var(--ref-color-gray-800);
    --comp-study-mode-btn-border-color: var(--ref-color-twilight-300);
    
    /* Thumbnails */
    --comp-thumbnails-bg: var(--ref-color-gray-exception-600-a8);
    --comp-thumbnails-fg: var(--ref-color-gray-600);
    --comp-thumbnails-fg-draft: var(--ref-color-gray-400);
    
    /* Toast */
    --comp-toast-bg-status-upgrade: var(--ref-color-twilight-900);
    
    /* Pulse Callout */
    --comp-pulse-callout-border: var(--ref-color-twilight-400);
}

/* ----------------------------------------
   Semantic Aliases (for backwards compatibility)
   ---------------------------------------- */
:root {
    /* Legacy color aliases */
    --color-primary: var(--ref-color-twilight-500);
    --color-primary-hover: var(--ref-color-twilight-600);
    --color-primary-light: var(--ref-color-twilight-400);
    --color-sunset: var(--ref-color-sunset-400);
    --color-mint: var(--ref-color-mint-200);
    --color-mint-accent: var(--ref-color-mint-400);
    --color-cherry: var(--ref-color-magenta-500);
    --color-success: var(--ref-color-mint-500);
    
    /* Twilight color aliases */
    --twilight-100: var(--ref-color-twilight-100);
    --twilight-200: var(--ref-color-twilight-200);
    --twilight-300: var(--ref-color-twilight-300);
    --twilight-400: var(--ref-color-twilight-400);
    --twilight-500: var(--ref-color-twilight-500);
    --twilight-600: var(--ref-color-twilight-600);
    --twilight-700: var(--ref-color-twilight-700);
    
    /* Mint color aliases */
    --color-mint-100: var(--ref-color-mint-100);
    --color-mint-200: var(--ref-color-mint-200);
    --color-mint-300: var(--ref-color-mint-300);
    --color-mint-400: var(--ref-color-mint-400);
    --color-mint-500: var(--ref-color-mint-500);
    --color-mint-600: var(--ref-color-mint-600);
    
    /* Legacy gray scale */
    --color-gray-800: var(--ref-color-gray-800);
    --color-gray-700: var(--ref-color-gray-700);
    --color-gray-600: var(--ref-color-gray-600);
    --color-gray-500: var(--ref-color-gray-500);
    --color-gray-400: var(--ref-color-gray-400);
    --color-gray-300: var(--ref-color-gray-300);
    --color-gray-200: var(--ref-color-gray-200);
    
    /* Legacy semantic colors */
    --text-primary: var(--sys-text-primary);
    --text-secondary: var(--sys-text-secondary);
    --text-tertiary: var(--ref-color-gray-500);
    --text-muted: var(--ref-color-gray-500);
    --surface-base: var(--sys-surface-base);
    --surface-raised: var(--sys-surface-raised);
    --surface: var(--sys-surface-base);
    --surface-hover: var(--ref-color-gray-200);
    --border: var(--sys-border-primary);
    --border-default: var(--ref-color-gray-200);
    
    /* Shadows */
    --shadow-card: 0px var(--ref-shadow-offset-medium) var(--ref-shadow-blur-large) 0px var(--ref-color-shadow);
    --shadow-sm: 0px var(--ref-shadow-offset-small) var(--ref-shadow-blur-medium) 0px var(--ref-color-shadow);
    
    /* Legacy spacing */
    --spacing-xxs: var(--ref-spacing-xxsmall);
    --spacing-xs: var(--ref-spacing-xsmall);
    --spacing-sm: var(--ref-spacing-small);
    --spacing-md: var(--ref-spacing-medium);
    --spacing-lg: var(--ref-spacing-large);
    --spacing-xl: var(--ref-spacing-xlarge);
    --spacing-xxl: var(--ref-spacing-xxlarge);
    
    /* Legacy radius */
    --radius-sm: var(--ref-radius-small);
    --radius-md: var(--ref-radius-medium);
    --radius-lg: var(--ref-radius-large);
    --radius-xl: var(--ref-radius-xlarge);
    --radius-full: var(--ref-radius-full);
    
    /* Typography */
    --font-family: var(--ref-typography-font-family), -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    
    /* Transitions */
    --transition-fast: 150ms var(--ref-anim-ease-persist);
    --transition-normal: 250ms var(--ref-anim-ease-persist);
}

/* ----------------------------------------
   Dark Mode System Tokens
   ---------------------------------------- */
@media (prefers-color-scheme: dark) {
    :root.auto-dark {
        /* Surfaces */
        --sys-surface-base: var(--ref-color-twilight-900);
        --sys-surface-base-none: var(--ref-color-twilight-900-none);
        --sys-surface-raised: var(--ref-color-gray-exception-750);
        --sys-surface-raised-transparent: var(--ref-color-gray-exception-100-a8);
        --sys-surface-inverse: var(--ref-color-gray-300);
        
        /* Text */
        --sys-text-primary: var(--ref-color-gray-200);
        --sys-text-secondary: var(--ref-color-gray-400);
        --sys-text-inverse: var(--ref-color-gray-800);
        --sys-text-highlight: var(--ref-color-twilight-300);
        --sys-text-status-success: var(--ref-color-mint-400);
        --sys-text-status-warning: var(--ref-color-sherbert-400);
        --sys-text-status-error: var(--ref-color-cherry-300);
        
        /* Border */
        --sys-border-primary: var(--ref-color-gray-800);
        --sys-border-transparent: var(--ref-color-gray-exception-100-a8);
        --sys-border-status-success: var(--ref-color-mint-400);
        --sys-border-status-warning: var(--ref-color-sherbert-500);
        --sys-border-status-error: var(--ref-color-cherry-300);
        
        /* Interactive - Background - Primary */
        --sys-interactive-bg-primary-disabled: var(--ref-color-gray-700);
        
        /* Interactive - Background - Secondary */
        --sys-interactive-bg-secondary-default: var(--ref-color-gray-600);
        --sys-interactive-bg-secondary-hover: var(--ref-color-gray-700);
        --sys-interactive-bg-secondary-focus: var(--ref-color-gray-600);
        --sys-interactive-bg-secondary-press: var(--ref-color-gray-800);
        --sys-interactive-bg-secondary-disabled: var(--ref-color-gray-700);
        --sys-interactive-bg-secondary-selected: var(--ref-color-gray-600);
        
        /* Interactive - Background - Tertiary */
        --sys-interactive-bg-tertiary-default: var(--ref-color-gray-700);
        --sys-interactive-bg-tertiary-hover: var(--ref-color-gray-800);
        --sys-interactive-bg-tertiary-focus: var(--ref-color-gray-700);
        --sys-interactive-bg-tertiary-press: var(--ref-color-gray-900);
        --sys-interactive-bg-tertiary-disabled: var(--ref-color-gray-700);
        --sys-interactive-bg-tertiary-selected: var(--ref-color-gray-700);
        
        /* Interactive - Background - Status */
        --sys-interactive-bg-status-upgrade-disabled: var(--ref-color-gray-700);
        --sys-interactive-bg-status-danger-disabled: var(--ref-color-gray-700);
        
        /* Interactive - Foreground - Primary */
        --sys-interactive-fg-primary-disabled: var(--ref-color-gray-600);
        
        /* Interactive - Foreground - Secondary */
        --sys-interactive-fg-secondary-default: var(--ref-color-gray-200);
        --sys-interactive-fg-secondary-hover: var(--ref-color-gray-200);
        --sys-interactive-fg-secondary-focus: var(--ref-color-gray-200);
        --sys-interactive-fg-secondary-press: var(--ref-color-gray-200);
        --sys-interactive-fg-secondary-disabled: var(--ref-color-gray-600);
        --sys-interactive-fg-secondary-selected: var(--ref-color-gray-200);
        
        /* Interactive - Foreground - Tertiary */
        --sys-interactive-fg-tertiary-default: var(--ref-color-gray-200);
        --sys-interactive-fg-tertiary-hover: var(--ref-color-gray-200);
        --sys-interactive-fg-tertiary-focus: var(--ref-color-gray-200);
        --sys-interactive-fg-tertiary-press: var(--ref-color-gray-200);
        --sys-interactive-fg-tertiary-disabled: var(--ref-color-gray-600);
        --sys-interactive-fg-tertiary-selected: var(--ref-color-gray-200);
        
        /* Interactive - Foreground - Status */
        --sys-interactive-fg-status-upgrade-disabled: var(--ref-color-gray-600);
        --sys-interactive-fg-status-danger-disabled: var(--ref-color-gray-600);
        
        /* Interactive - Text Button */
        --sys-interactive-text-bg-primary-hover: var(--ref-color-gray-800);
        --sys-interactive-text-bg-primary-press: var(--ref-color-gray-900);
        --sys-interactive-text-bg-secondary-hover: var(--ref-color-gray-800);
        --sys-interactive-text-bg-secondary-press: var(--ref-color-gray-900);
        --sys-interactive-text-fg-primary-default: var(--ref-color-twilight-300);
        --sys-interactive-text-fg-primary-hover: var(--ref-color-twilight-500);
        --sys-interactive-text-fg-primary-focus: var(--ref-color-twilight-300);
        --sys-interactive-text-fg-primary-press: var(--ref-color-twilight-600);
        --sys-interactive-text-fg-primary-visited: var(--ref-color-twilight-200);
        --sys-interactive-text-fg-primary-disabled: var(--ref-color-gray-600);
        --sys-interactive-text-fg-secondary-default: var(--ref-color-gray-200);
        --sys-interactive-text-fg-secondary-hover: var(--ref-color-gray-500);
        --sys-interactive-text-fg-secondary-focus: var(--ref-color-gray-200);
        --sys-interactive-text-fg-secondary-press: var(--ref-color-gray-600);
        --sys-interactive-text-fg-secondary-visited: var(--ref-color-gray-400);
        --sys-interactive-text-fg-secondary-disabled: var(--ref-color-gray-600);
        --sys-interactive-text-fg-status-danger-default: var(--ref-color-cherry-400);
        
        /* Interactive - Border */
        --sys-interactive-border-primary-default: var(--ref-color-gray-200);
        --sys-interactive-border-primary-disabled: var(--ref-color-gray-600);
        
        /* Component Tokens - Dark Mode Overrides */
        --comp-input-bg-default: var(--ref-color-gray-700);
        --comp-input-text-disabled: var(--ref-color-gray-600);
        --comp-content-list-item-bg-hover: var(--ref-color-gray-700);
        --comp-content-list-item-bg-press: var(--ref-color-gray-800);
        --comp-pills-bg-metadata-primary: var(--ref-color-gray-200);
        --comp-pills-bg-metadata-secondary: var(--ref-color-gray-600);
        --comp-pills-fg-metadata-primary: var(--ref-color-gray-800);
        --comp-pills-fg-metadata-secondary: var(--ref-color-gray-200);
        --comp-progress-bar-bg-empty: var(--ref-color-gray-600);
        --comp-page-indicator-bg-active: var(--ref-color-gray-100);
        --comp-page-indicator-bg-inactive: var(--ref-color-gray-exception-100-a32);
        --comp-shimmer-bg-solid: var(--ref-color-gray-exception-100-a8);
        --comp-shimmer-bg-gradient-edge: var(--ref-color-gray-100-none);
        --comp-shimmer-bg-gradient-center: var(--ref-color-gray-exception-100-a8);
        --comp-study-mode-btn-bg-default: var(--ref-color-gray-700);
        --comp-study-mode-btn-bg-pressed: var(--ref-color-gray-800);
        --comp-study-mode-btn-fg-default: var(--ref-color-twilight-200);
        --comp-thumbnails-bg: var(--ref-color-gray-exception-100-a8);
        --comp-thumbnails-fg: var(--ref-color-gray-300);
        --comp-thumbnails-fg-draft: var(--ref-color-gray-300);
        --comp-toast-bg-status-upgrade: var(--ref-color-gray-300);
    }
}

/* Manual dark mode class */
:root.dark-mode {
    /* Surfaces */
    --sys-surface-base: var(--ref-color-twilight-900);
    --sys-surface-base-none: var(--ref-color-twilight-900-none);
    --sys-surface-raised: var(--ref-color-gray-exception-750);
    --sys-surface-inverse: var(--ref-color-gray-300);
    
    /* Text */
    --sys-text-primary: var(--ref-color-gray-200);
    --sys-text-secondary: var(--ref-color-gray-400);
    --sys-text-inverse: var(--ref-color-gray-800);
    --sys-text-highlight: var(--ref-color-twilight-300);
    --sys-text-status-error: var(--ref-color-cherry-300);
    
    /* Border */
    --sys-border-primary: var(--ref-color-gray-800);
    
    /* Legacy aliases for dark mode */
    --surface-base: var(--sys-surface-base);
    --surface-raised: var(--sys-surface-raised);
    --surface: var(--sys-surface-base);
    --surface-hover: var(--ref-color-gray-700);
    --text-primary: var(--sys-text-primary);
    --text-secondary: var(--sys-text-secondary);
    --text-tertiary: var(--ref-color-gray-500);
    --border: var(--sys-border-primary);
}

/* ============================================
   Reset & Base Styles
   ============================================ */
*, *::before, *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    font-family: var(--font-family);
    background-color: var(--surface-base);
    color: var(--text-primary);
    line-height: 1.5;
    min-height: 100vh;
}

button {
    font-family: inherit;
    cursor: pointer;
    border: none;
    background: none;
    transition: all var(--transition-fast);
}

img {
    display: block;
    max-width: 100%;
}

ul {
    list-style: none;
}

/* Material Symbols */
.material-symbols-rounded {
    font-variation-settings:
        'FILL' 0,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
    font-size: 24px;
    line-height: 1;
}

/* Universal filled star icon - applies to any starred state */
.material-symbols-rounded.filled,
.starred .material-symbols-rounded,
.starred.material-symbols-rounded,
button.starred .material-symbols-rounded,
.term-star-btn.starred .material-symbols-rounded,
.panel-term-star.starred .material-symbols-rounded,
.table-term-star.starred .material-symbols-rounded,
.control-btn.starred .material-symbols-rounded,
.experience-control-btn.star.starred .material-symbols-rounded,
.study-mode-card-star.starred .material-symbols-rounded {
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24 !important;
}

/* ============================================
   Top Navigation
   ============================================ */
.top-nav {
    position: sticky;
    top: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: var(--spacing-xxl);
    padding: 0 var(--spacing-lg) 0 var(--spacing-sm);
    background: var(--surface-base);
}

.nav-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding-right: var(--spacing-lg);
}

.icon-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-xs);
    border-radius: var(--radius-md);
}

.icon-btn:hover {
    background: var(--color-gray-200);
}

.icon-btn .material-symbols-rounded {
    color: var(--text-secondary);
}

.logo {
    display: flex;
    align-items: center;
}

/* Search Bar */
.search-bar {
    flex: 1;
    max-width: 600px;
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) 12px;
    background: var(--color-gray-300);
    border-radius: var(--radius-md);
}

.search-placeholder {
    font-size: 14px;
    font-weight: 600;
    color: var(--color-gray-500);
    line-height: 20px;
}

.search-icon {
    color: var(--color-gray-500);
}

/* Nav Right */
.nav-right {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding-left: var(--spacing-lg);
}

.create-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--color-primary);
    border-radius: var(--radius-full);
}

.create-btn:hover {
    background: var(--color-primary-hover);
}

.create-btn .material-symbols-rounded {
    color: white;
}

.upgrade-btn {
    padding: 10px var(--spacing-sm);
    background: var(--color-sunset);
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    color: var(--color-gray-800);
    line-height: 20px;
}

.upgrade-btn:hover {
    filter: brightness(0.95);
}

.avatar {
    width: 40px;
    height: 40px;
    border-radius: 100px;
    overflow: hidden;
    background: var(--color-primary);
}

.avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* ============================================
   Main Content Layout
   ============================================ */
.main-content {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-xl);
    max-width: 1366px;
    margin: 0 auto;
    padding: 24px 100px 0;
    height: calc(100vh - 64px); /* Viewport height minus header */
    overflow: hidden;
}

/* ============================================
   Sidebar
   ============================================ */
.sidebar {
    flex: 0 0 400px;
    max-width: 400px;
    overflow-y: auto;
    height: 100%;
    padding-bottom: var(--spacing-xl);
}

/* Custom scrollbar for sidebar */
.sidebar::-webkit-scrollbar {
    width: 6px;
}

.sidebar::-webkit-scrollbar-track {
    background: transparent;
}

.sidebar::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 3px;
}

.sidebar::-webkit-scrollbar-thumb:hover {
    background: var(--text-muted);
}

.set-info {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.set-title {
    font-size: 32px;
    font-weight: 700;
    line-height: 40px;
    color: var(--text-primary);
}

.set-meta {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--spacing-md);
}

.user-link {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.user-avatar {
    width: 24px;
    height: 24px;
    border-radius: 100px;
    overflow: hidden;
    background: var(--color-gray-300);
}

.user-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.username {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-secondary);
    line-height: 24px;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: var(--ref-typography-size-subheading-four);
    font-weight: var(--ref-typography-weight-subheader);
    color: var(--text-secondary);
    line-height: var(--ref-typography-line-height-subheading-four);
}

/* Primary Actions (Study/Remix) */
.primary-actions {
    display: flex;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-md);
}

.sidebar-study-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1;
    gap: 6px;
    padding: 12px 16px;
    background: var(--color-primary);
    color: white;
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    transition: all var(--transition-fast);
}

.sidebar-study-btn:hover {
    background: var(--color-primary-hover);
}

.sidebar-study-btn .material-symbols-rounded {
    font-size: 20px;
}

.sidebar-remix-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1;
    gap: 6px;
    padding: 12px 16px;
    background: var(--twilight-100);
    color: var(--twilight-500);
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    transition: all var(--transition-fast);
}

.sidebar-remix-btn:hover {
    background: var(--twilight-200);
}

.sidebar-remix-btn .material-symbols-rounded {
    font-size: 20px;
}

.action-buttons {
    display: flex;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-sm);
    width: 100%;
}

.action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    min-width: 44px;
    min-height: 44px;
    flex-shrink: 0;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
}

.action-btn:hover {
    background: var(--color-gray-300);
}

.action-btn .material-symbols-rounded {
    color: var(--text-secondary);
}

/* Sort & Filter Controls */
.toc-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: var(--spacing-md);
    margin-bottom: 8px;
}

.toc-control-btn {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: 0;
    background: transparent;
    border: none;
    border-radius: 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.toc-control-btn:hover {
    background: transparent;
    color: var(--text-primary);
}

.toc-control-btn.active {
    background: transparent;
    color: var(--color-primary);
}

.toc-control-btn .material-symbols-rounded {
    font-size: 18px;
}

/* Dropdown Menu */
.dropdown-menu {
    background: var(--surface-base);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-card);
    min-width: 180px;
    padding: var(--spacing-xs);
    animation: dropdownFadeIn 0.15s ease;
}

@keyframes dropdownFadeIn {
    from {
        opacity: 0;
        transform: translateY(-4px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.dropdown-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    width: 100%;
    padding: var(--spacing-xs) var(--spacing-sm);
    background: transparent;
    border: none;
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.dropdown-item:hover {
    background: var(--color-gray-200);
}

.dropdown-item.active {
    background: var(--ref-color-twilight-100);
    color: var(--color-primary);
    border-radius: var(--radius-full);
}

.dropdown-item .material-symbols-rounded {
    font-size: 20px;
    color: var(--text-secondary);
}

.dropdown-item.active .material-symbols-rounded {
    color: var(--color-primary);
}

.dropdown-item .check {
    margin-left: auto;
    font-size: 18px;
}

/* TOC Empty State */
.toc-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-xl);
    text-align: center;
    color: var(--text-secondary);
}

.toc-empty .material-symbols-rounded {
    font-size: 48px;
    margin-bottom: var(--spacing-sm);
    opacity: 0.5;
}

.toc-empty p {
    font-size: 14px;
    font-weight: 500;
}

/* Topics */
.topics-container,
.journey-topics-container {
    margin-top: 0;
    margin-bottom: var(--spacing-xl);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
}

.topic-section {
    display: flex;
    flex-direction: column;
    gap: 0;
}

/* Flat terms list (no collapsible header) */
.flat-terms-list {
    display: flex;
    flex-direction: column;
    gap: 0;
}

.topic-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-sm) var(--spacing-md);
    cursor: pointer;
    color: var(--text-secondary);
    user-select: none;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    transition: background var(--transition-fast);
    height: 56px;
}

.topic-header:hover {
    background: var(--color-gray-300);
}

.topic-header:focus,
.topic-header.active,
.topic-section.active .topic-header {
    background: var(--color-gray-200);
}

.topic-title {
    font-size: 16px;
    font-weight: 600;
    line-height: 24px;
    color: var(--text-secondary);
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.topic-title.secondary {
    color: var(--text-secondary);
}

.topic-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    color: var(--text-secondary);
    transition: transform 0.25s ease;
    flex-shrink: 0;
}

.topic-section.collapsed .topic-toggle {
    transform: rotate(-90deg);
}

.topic-section.collapsed .topic-cards {
    display: none;
}

.topic-section.collapsed .topic-header {
    margin-bottom: 0;
}

/* Term Cards Container */
.topic-cards {
    display: flex;
    flex-direction: column;
    background: transparent;
    border-radius: 0;
    overflow: hidden;
}

/* Individual Term Card */
.term-card {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    padding: var(--spacing-md) 0;
    background: transparent;
    border-bottom: 1px solid var(--border-default);
    cursor: pointer;
    transition: background var(--transition-fast);
}

.term-card:last-child {
    border-bottom: none;
}


.term-card.active {
    background: var(--surface-base);
    border-bottom: 2px solid var(--ref-color-twilight-100);
}

/* Audio Button */
.term-audio-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    flex-shrink: 0;
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.term-audio-btn:hover {
    background: var(--color-gray-300);
    color: var(--color-primary);
}

.term-audio-btn.playing {
    color: var(--color-primary);
}

/* Term Content */
.term-content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.term-title {
    font-size: 14px;
    font-weight: 600;
    line-height: 20px;
    color: var(--text-primary);
}

.term-definition {
    font-size: 14px;
    font-weight: 400;
    line-height: 20px;
    color: var(--text-secondary);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Term Actions Container (right side grouping) */
.term-actions {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-xs);
    flex-shrink: 0;
}

/* Star Button */
.term-star-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    flex-shrink: 0;
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.term-star-btn:hover {
    background: var(--color-gray-300);
}

.term-star-btn.starred {
    color: var(--color-sunset);
}

.term-star-btn.starred .material-symbols-rounded {
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24 !important;
}

/* Term Status Icon (Know/Still Learning) */
.term-status-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    flex-shrink: 0;
}

.term-status-icon.known {
    background: var(--color-mint-100);
}

.term-status-icon.known .material-symbols-rounded {
    color: var(--color-mint-500);
    font-size: 24px;
    font-variation-settings: 
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
}

.term-status-icon.learning {
    background: var(--color-gray-200);
}

.term-status-icon.learning .material-symbols-rounded {
    color: var(--color-gray-400);
    font-size: 24px;
}

/* ============================================
   Sidebar Progress View (Variant A)
   ============================================ */

/* Progress bar in header (replaces metadata when engaged) */
.sidebar-progress-view {
    display: none;
    flex-direction: column;
    gap: 4px;
}

.sidebar-progress-bar {
    width: 100%;
    height: 4px !important;
    min-height: 4px;
    background: var(--color-mint-100);
    border-radius: var(--radius-full);
    overflow: visible;
    position: relative;
}

.sidebar-progress-fill {
    height: 100%;
    background: var(--color-mint-500);
    border-radius: var(--radius-full);
    transition: width 0.3s ease;
    width: 0%;
    position: relative;
    min-width: 4px;
}

/* Placeholder circle at start of empty progress bar */
.sidebar-progress-fill::after {
    content: '';
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    height: 4px;
    background: var(--color-mint-500);
    border-radius: 50%;
}

.sidebar-progress-text {
    font-size: var(--ref-typography-size-subheading-four);
    font-weight: var(--ref-typography-weight-subheader);
    color: var(--text-secondary);
    line-height: var(--ref-typography-line-height-subheading-four);
    margin-top: 4px;
}

/* Progress ring for concept groups */
.sidebar-progress-ring {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: var(--spacing-sm);
}

.sidebar-progress-ring svg {
    display: block;
}

.sidebar-progress-ring .progress-ring-bg {
    stroke: var(--ref-color-gray-400);
}

.sidebar-progress-ring .progress-ring-fill {
    stroke: var(--color-mint-500);
    stroke-linecap: round;
    transition: stroke-dashoffset 0.3s ease;
}

.sidebar-progress-ring {
    position: relative;
}

.sidebar-progress-ring .progress-ring-check {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 14px;
    color: var(--color-mint-500);
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
}

/* Topic header in progress view */
.topic-section.progress-view .topic-header {
    gap: var(--spacing-xs);
}

.topic-section.progress-view .topic-title {
    flex: 1;
}

/* Term card in progress view */
.term-card.progress-view {
    gap: var(--spacing-sm);
}

.topic-divider {
    height: 2px;
    background: var(--color-gray-300);
    margin-top: var(--spacing-md);
}

/* About Section */
.sidebar .about-section {
    margin-top: 0;
}

.sidebar .about-title {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    margin: 0 0 var(--spacing-sm) 0;
    letter-spacing: 0.01em;
}

.sidebar .about-description {
    font-size: 15px;
    font-weight: 400;
    line-height: 1.6;
    color: var(--text-primary);
    margin: 0;
}

/* Creator Info */
.sidebar .creator-info {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-lg) 0;
    margin-top: var(--spacing-lg);
}

.sidebar .creator-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
    background: var(--color-primary);
}

.sidebar .creator-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.sidebar .creator-details {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.sidebar .creator-name {
    font-size: 15px;
    color: var(--text-primary);
    font-weight: 400;
}

.sidebar .creator-name strong {
    font-weight: 600;
    color: var(--text-primary);
}

.sidebar .creator-badge {
    font-size: 13px;
    color: var(--text-secondary);
    font-weight: 400;
}

/* Metadata List */
.sidebar .metadata-list {
    display: flex;
    flex-direction: column;
    gap: 0;
}

.sidebar .metadata-item {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-md);
    padding: var(--spacing-lg) 0;
    border-top: 1px solid var(--border-default);
}

.sidebar .metadata-item:last-child {
    padding-bottom: 0;
}

.sidebar .metadata-icon {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-secondary);
    flex-shrink: 0;
    font-size: 22px;
}

.sidebar .metadata-icon.metadata-icon-text {
    font-size: 16px;
    font-weight: 700;
    color: var(--text-secondary);
}

.sidebar .metadata-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.sidebar .metadata-label {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
}

.sidebar .metadata-value {
    font-size: 14px;
    color: var(--text-secondary);
    font-weight: 400;
    line-height: 1.4;
}

/* Topics container spacing */
.topics-container,
.journey-topics-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

/* TOC Loading State */
.toc-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-xl) var(--spacing-md);
    color: var(--text-muted);
    font-size: 14px;
    font-weight: 500;
}

.toc-loading-spinner {
    width: 24px;
    height: 24px;
    border: 3px solid var(--color-gray-300);
    border-top-color: var(--color-primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* Shimmer Animation */
@keyframes shimmer {
    0% {
        background-position: 200% 0;
    }
    100% {
        background-position: -200% 0;
    }
}

.shimmer {
    position: relative;
    overflow: hidden;
    background: var(--color-gray-200);
}

.shimmer::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        var(--color-gray-300) 50%,
        transparent 100%
    );
    animation: shimmer 1.5s ease-in-out infinite;
}

/* Full-width skeleton pill for concept groups */
.skeleton-pill {
    height: 56px;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    position: relative;
    overflow: hidden;
}

.skeleton-pill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        var(--color-gray-300) 50%,
        transparent 100%
    );
    animation: shimmer 1.5s ease-in-out infinite;
}

/* Skeleton Cards for Loading States */
.skeleton-card {
    height: 120px;
    background: var(--color-gray-200);
    border-radius: var(--radius-xl);
    position: relative;
    overflow: hidden;
}

.skeleton-card::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        var(--color-gray-300) 50%,
        transparent 100%
    );
    animation: shimmer 1.5s ease-in-out infinite;
}

.skeleton-header {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
}

.skeleton-icon {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-md);
}

.skeleton-text-group {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.skeleton-title {
    height: 16px;
    width: 80%;
}

.skeleton-subtitle {
    height: 12px;
    width: 50%;
}

.skeleton-meta {
    display: flex;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-xs);
}

.skeleton-tag {
    height: 20px;
    width: 60px;
    border-radius: var(--radius-full);
}

/* Skeleton Term Card */
.skeleton-term {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    padding: var(--spacing-md) 0;
    border-bottom: 1px solid var(--border-light);
}

.skeleton-term:last-child {
    border-bottom: none;
}

.skeleton-term-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.skeleton-term-title {
    height: 14px;
    width: 60%;
}

.skeleton-term-definition {
    height: 12px;
    width: 90%;
}

.skeleton-term-actions {
    display: flex;
    gap: var(--spacing-xs);
}

.skeleton-action-btn {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-full);
}

/* TOC Loading Skeleton */
.toc-loading-skeleton {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    padding: 0;
}

/* ============================================
   Study Area
   ============================================ */
.study-area {
    width: 632px;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    overflow-y: auto;
    flex: 1;
    min-height: 0;
    padding: 0 20px 20px 20px;
    margin: 0 -20px -20px 0;
    position: relative;
    z-index: 2;
}

/* Custom scrollbar for study area */
.study-area::-webkit-scrollbar {
    width: 6px;
}

.study-area::-webkit-scrollbar-track {
    background: transparent;
}

.study-area::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 3px;
}

.study-area::-webkit-scrollbar-thumb:hover {
    background: var(--text-muted);
}

/* Tab Navigation */
.study-tabs {
    display: flex;
    gap: 0;
    background: var(--color-gray-200);
    padding: var(--spacing-xxs);
    border-radius: var(--radius-full);
}

.tab-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xxs);
    padding: 12px var(--spacing-md);
    border-radius: var(--radius-full);
    font-size: 16px;
    font-weight: 600;
    color: var(--text-secondary);
    line-height: 24px;
    background: transparent;
}

.tab-btn:hover {
    color: var(--text-primary);
}

.tab-btn.active {
    background: var(--surface-base);
    color: var(--text-primary);
}

/* Flashcard */
.flashcard-wrapper {
    display: flex;
    justify-content: center;
    padding: 0;
}

.flashcard-stack {
    position: relative;
    width: 100%;
    perspective: 1000px;
}

.flashcard-bg {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 398px;
    background: var(--surface-raised);
    border: 1px solid var(--color-gray-200);
    border-radius: 42px;
    box-shadow: var(--shadow-card);
    transform: rotate(2deg);
}

.flashcard {
    position: relative;
    width: 100%;
    height: 398px;
    cursor: pointer;
    z-index: 1;
}

.flashcard-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    transform-style: preserve-3d;
}

.flashcard.flipped .flashcard-inner {
    transform: rotateX(180deg);
}

.flashcard-front,
.flashcard-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    background: var(--surface-raised);
    border: 1px solid var(--color-gray-200);
    border-radius: 42px;
    box-shadow: var(--shadow-card);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 42px;
}

.flashcard-back {
    transform: rotateX(180deg);
}

.flashcard-text {
    font-size: 20px;
    font-weight: 600;
    text-align: center;
    line-height: 28px;
    color: var(--text-primary);
    max-width: 417px;
}


/* Flashcard Controls */
.flashcard-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0;
}

.control-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-xs) var(--spacing-sm);
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    min-width: 40px;
    min-height: 40px;
}

.control-btn:hover {
    background: var(--color-gray-300);
}

.control-btn .material-symbols-rounded {
    color: var(--text-secondary);
}

.nav-controls {
    display: flex;
    gap: var(--spacing-md);
}

.control-btn.starred .material-symbols-rounded {
    color: var(--color-sunset);
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24 !important;
}

/* Set Metadata Module */
.set-metadata {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    padding: var(--spacing-lg);
    background: var(--surface-raised);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-xl);
}

.about-section {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.about-title {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    margin: 0;
}

.about-description {
    font-size: 15px;
    font-weight: 400;
    line-height: 1.6;
    color: var(--text-primary);
    margin: 0;
}

.about-loading {
    color: var(--text-muted);
    font-style: italic;
}

.creator-section {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding-top: var(--spacing-sm);
}

.creator-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    overflow: hidden;
    background: var(--color-primary);
    flex-shrink: 0;
}

.creator-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.creator-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.creator-name {
    font-size: 15px;
    font-weight: 700;
    color: var(--text-primary);
}

.creator-badge {
    font-size: 13px;
    font-weight: 500;
    color: var(--color-primary);
}

.metadata-divider {
    height: 1px;
    background: var(--border-default);
    margin: var(--spacing-xs) 0;
}

.badges-section {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.badge-item {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
}

.badge-icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.badge-icon-text {
    font-size: 16px;
    font-weight: 800;
    color: var(--text-secondary);
}

.badge-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
    padding-top: 2px;
}

.badge-title {
    font-size: 15px;
    font-weight: 700;
    color: var(--text-primary);
}

.badge-subtitle {
    font-size: 13px;
    font-weight: 400;
    color: var(--text-muted);
}

/* Ad Container */
.ad-container {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-md) var(--spacing-sm);
    background: var(--color-gray-200);
    border-radius: var(--radius-xl);
}

.ad-placeholder {
    width: 580px;
    height: 400px;
    background: var(--color-mint);
    border-radius: var(--radius-sm);
    display: flex;
    align-items: center;
    justify-content: center;
}

.ad-placeholder span {
    font-size: 16px;
    font-weight: 700;
    color: var(--color-mint-accent);
    line-height: 24px;
}

/* Similar Study Sets */
.similar-sets {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.similar-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-secondary);
    line-height: 24px;
}

.sets-grid {
    display: flex;
    gap: 20px;
}

.study-set-card {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: var(--spacing-lg);
    background: var(--surface-raised);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-card);
    overflow: hidden;
}

.card-header {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
}

.set-icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--ref-color-twilight-100);
    border-radius: var(--radius-md);
    flex-shrink: 0;
}

.set-icon .material-symbols-rounded {
    font-size: 20px;
    color: var(--color-primary);
}

.set-name {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    margin: 0;
}

.card-stats {
    display: flex;
    align-items: center;
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-md);
    padding-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--border-default);
}

.stat-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xxs);
    font-size: var(--ref-typography-size-subheading-four);
    font-weight: var(--ref-typography-weight-subheader);
    color: var(--text-secondary);
    line-height: var(--ref-typography-line-height-subheading-four);
}

.stat-item .material-symbols-rounded {
    font-size: 18px;
}

.stat-item .material-symbols-rounded.trending {
    color: var(--color-coral);
}

.stat-item .material-symbols-rounded.star {
    color: var(--color-sunset);
}

.stat-item .material-symbols-rounded.star.filled {
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
}

/* Term Preview Items */
.card-terms-preview {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    flex: 1;
}

.term-preview-item {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.preview-term {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
}

.preview-definition {
    font-size: 13px;
    font-weight: 400;
    color: var(--text-secondary);
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

/* Preview Button */
.card-preview-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs);
    width: 100%;
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--ref-color-twilight-100);
    border: none;
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    color: var(--color-primary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.card-preview-btn:hover {
    background: var(--ref-color-twilight-200);
}

.card-preview-btn .material-symbols-rounded {
    font-size: 18px;
}

/* ============================================
   Responsive Design
   ============================================ */
@media (max-width: 1280px) {
    .main-content {
        padding: var(--spacing-lg);
        gap: var(--spacing-lg);
    }
    
    .study-area {
        width: 100%;
        max-width: 632px;
    }
}

@media (max-width: 1024px) {
    .sidebar {
        max-width: 320px;
    }
    
    .search-bar {
        max-width: 400px;
    }
}

@media (max-width: 768px) {
    .top-nav {
        padding: 0 var(--spacing-sm);
    }
    
    .search-bar {
        display: none;
    }
    
    .upgrade-btn {
        display: none;
    }
    
    .main-content {
        flex-direction: column;
        padding: var(--spacing-sm);
        height: auto;
        overflow: visible;
    }
    
    .sidebar {
        max-width: 100%;
        display: none;
        height: auto;
        overflow: visible;
    }
    
    .study-area {
        max-width: 100%;
        height: auto;
        overflow: visible;
    }
    
    .tab-btn span {
        display: none;
    }
    
    .tab-btn {
        padding: 12px var(--spacing-sm);
    }
    
    .flashcard,
    .flashcard-bg {
        height: 300px;
    }
    
    .flashcard-front,
    .flashcard-back {
        padding: var(--spacing-md);
        border-radius: var(--spacing-md);
    }
    
    .flashcard-bg {
        border-radius: var(--spacing-md);
    }
    
    .ad-placeholder {
        width: 100%;
        height: 300px;
    }
    
    .sets-grid {
        flex-direction: column;
    }
}

/* ============================================
   Fullscreen Mode
   ============================================ */
body.fullscreen-mode .top-nav,
body.fullscreen-mode .sidebar,
body.fullscreen-mode .ad-container,
body.fullscreen-mode .similar-sets {
    display: none;
}

body.fullscreen-mode .main-content {
    padding: var(--spacing-xl);
    justify-content: center;
    align-items: center;
    min-height: 100vh;
}

body.fullscreen-mode .study-area {
    max-width: 800px;
}

body.fullscreen-mode .flashcard,
body.fullscreen-mode .flashcard-bg {
    height: 500px;
}

/* ============================================
   Animations
   ============================================ */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.flashcard {
    animation: fadeIn 0.4s ease;
}

/* ============================================
   Focus States
   ============================================ */
button:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
}

/* ============================================
   Scrollbar - Hidden but scrollable
   ============================================ */

/* Hide scrollbar for Chrome, Safari and Opera */
::-webkit-scrollbar {
    display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
* {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
}

/* Ensure body and html can still scroll */
html, body {
    overflow-y: auto;
}

/* ============================================
   Import Modal
   ============================================ */

/* Lock body scroll when modal is open */
body.modal-open {
    overflow: hidden;
}

.import-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(12px);
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-md);
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.25s ease, visibility 0.25s ease;
    overflow-y: auto;
}

.import-modal-overlay.active {
    opacity: 1;
    visibility: visible;
}

.import-modal {
    width: 100%;
    max-width: 600px;
    max-height: calc(100vh - var(--spacing-xl));
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 24px;
    box-shadow: 0 24px 80px -12px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(0, 0, 0, 0.05);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transform: translateY(16px) scale(0.97);
    transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
    margin: auto;
}

.import-modal.layout-modal {
    max-width: 520px;
}

.import-modal.layout-modal .import-modal-content {
    padding: var(--spacing-xl);
}

.import-modal-overlay.active .import-modal {
    transform: translateY(0) scale(1);
}

.import-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-lg) var(--spacing-xl);
    background: var(--surface);
    border-bottom: 1px solid var(--border);
}

.import-title {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 18px;
    font-weight: 700;
    color: var(--text-primary);
    letter-spacing: -0.02em;
}

.import-title.hidden {
    display: none;
}

.import-title .material-symbols-rounded {
    font-size: 24px;
    color: var(--ref-color-twilight-500);
}

.import-close-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: var(--radius-full);
    color: var(--text-tertiary);
    background: var(--color-gray-100);
    transition: all 0.15s ease;
}

.import-close-btn:hover {
    background: var(--color-gray-200);
    color: var(--text-primary);
}

.import-modal-content {
    padding: var(--spacing-lg);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    overflow-y: auto;
    flex: 1;
}

.import-field {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.import-label {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    letter-spacing: 0.01em;
}

.import-instructions {
    font-size: 13px;
    color: var(--text-tertiary);
    line-height: 1.4;
    margin: 0;
}

.import-title-input {
    width: 100%;
    padding: 12px var(--spacing-md);
    background: var(--color-gray-50);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    font-family: var(--font-family);
    font-size: 15px;
    font-weight: 500;
    color: var(--text-primary);
    transition: border-color 0.15s ease, box-shadow 0.15s ease;
}

.import-title-input::placeholder {
    color: var(--text-tertiary);
    font-weight: 400;
}

.import-title-input:focus {
    outline: none;
    border-color: var(--ref-color-twilight-500);
    box-shadow: 0 0 0 3px rgba(106, 92, 255, 0.12);
}

.import-textarea {
    width: 100%;
    height: 200px;
    padding: var(--spacing-md);
    background: var(--color-gray-50);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
    font-size: 13px;
    line-height: 1.6;
    color: var(--text-primary);
    resize: none;
    transition: border-color 0.15s ease, box-shadow 0.15s ease;
}

.import-textarea::placeholder {
    color: var(--text-tertiary);
}

.import-textarea:focus {
    outline: none;
    border-color: var(--ref-color-twilight-500);
    box-shadow: 0 0 0 3px rgba(106, 92, 255, 0.12);
}

/* Modal Steps */
.modal-step {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.modal-step.hidden {
    display: none;
}

.import-back-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    padding: 0;
    background: transparent;
    border: none;
    border-radius: var(--radius-md);
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.15s ease;
}

.import-back-btn:hover {
    background: var(--color-gray-200);
    color: var(--text-primary);
}

.import-back-btn .material-symbols-rounded {
    font-size: 22px;
}

/* Import Open Button */
.import-open-btn {
    background: var(--ref-color-twilight-500) !important;
    border-color: var(--ref-color-twilight-500) !important;
}

.import-open-btn .content-icon {
    background: rgba(255, 255, 255, 0.2);
    color: var(--ref-color-gray-100);
}

.import-open-btn .content-name {
    color: var(--ref-color-gray-100);
}

.import-open-btn:hover {
    background: var(--ref-color-twilight-600) !important;
    border-color: var(--ref-color-twilight-600) !important;
}

.import-open-btn:hover .content-icon {
    background: rgba(255, 255, 255, 0.2);
    color: var(--ref-color-gray-100);
}

/* Import Actions Group */
.import-actions-group {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-sm);
}

.import-submit-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs);
    width: 100%;
    padding: var(--spacing-md);
    background: var(--ref-color-twilight-500);
    border: none;
    border-radius: var(--radius-full);
    font-size: 15px;
    font-weight: 700;
    color: white;
    cursor: pointer;
    transition: all 0.15s ease;
}

.import-submit-btn:hover {
    background: var(--ref-color-twilight-600);
    box-shadow: 0 4px 12px rgba(106, 92, 255, 0.25);
}

.import-submit-btn:active {
    transform: translateY(0);
}

.import-submit-btn .material-symbols-rounded {
    font-size: 20px;
}

/* Debug Reset Button */
.debug-reset-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    padding: var(--spacing-md);
    background: var(--color-gray-200);
    border: none;
    border-radius: var(--radius-full);
    font-size: 15px;
    font-weight: 700;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.15s ease;
}

.debug-reset-btn:hover {
    background: var(--color-gray-300);
}

.debug-reset-btn .material-symbols-rounded {
    font-size: 18px;
}

/* Variant Selector */
.variant-field {
    gap: var(--spacing-xs);
}

.variant-selector {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

/* Modal Section Divider */
.modal-section-divider {
    height: 1px;
    background: var(--border);
    margin: var(--spacing-sm) calc(var(--spacing-xl) * -1);
}

/* Content Selector */
.content-field {
    margin-top: 0;
}

.content-selector {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.content-empty-state {
    font-size: 14px;
    color: var(--text-tertiary);
    text-align: center;
    padding: var(--spacing-lg);
    background: var(--color-gray-50);
    border-radius: var(--radius-lg);
    border: 1px dashed var(--border);
    margin: 0;
}

/* Content Loading State */
.content-loading-item {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-sm) var(--spacing-md);
    background: linear-gradient(90deg, var(--color-gray-100) 25%, var(--color-gray-50) 50%, var(--color-gray-100) 75%);
    background-size: 200% 100%;
    animation: shimmer 2s infinite ease-in-out;
    border: 2px solid var(--border);
    border-radius: var(--radius-lg);
    width: 100%;
    box-sizing: border-box;
}

.content-loading-icon {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-md);
    background: linear-gradient(90deg, var(--color-gray-200) 25%, var(--color-gray-100) 50%, var(--color-gray-200) 75%);
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
    flex-shrink: 0;
}

.content-loading-text {
    display: flex;
    flex-direction: column;
    gap: 8px;
    flex: 1;
}

.content-loading-title {
    height: 16px;
    width: 60%;
    border-radius: var(--radius-sm);
    background: linear-gradient(90deg, var(--color-gray-200) 25%, var(--color-gray-100) 50%, var(--color-gray-200) 75%);
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
}

.content-loading-desc {
    height: 12px;
    width: 80%;
    border-radius: var(--radius-sm);
    background: linear-gradient(90deg, var(--color-gray-200) 25%, var(--color-gray-100) 50%, var(--color-gray-200) 75%);
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
    animation-delay: 0.1s;
}

.content-btn {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--color-gray-50);
    border: 2px solid var(--border);
    border-radius: 16px;
    cursor: pointer;
    transition: all 0.2s ease;
    width: 100%;
    text-align: left;
    box-sizing: border-box;
    -webkit-appearance: none;
    appearance: none;
}

.content-btn:hover {
    background: var(--color-gray-100);
    border-color: var(--color-gray-300);
}

.content-btn.active {
    background: var(--ref-color-twilight-100);
    border-color: var(--ref-color-twilight-500);
}

.content-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--surface);
    border-radius: var(--radius-md);
    color: var(--text-tertiary);
    transition: all 0.2s ease;
    flex-shrink: 0;
}

.content-icon .material-symbols-rounded {
    font-size: 20px;
}

.content-btn:hover .content-icon {
    color: var(--text-secondary);
}

.content-btn.active .content-icon {
    background: var(--ref-color-twilight-500);
    color: white;
}

.content-btn-text {
    display: flex;
    flex-direction: column;
    gap: 2px;
    flex: 1;
    min-width: 0;
}

.content-name {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.content-desc {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.content-btn.active .content-name {
    color: var(--ref-color-twilight-700);
}

/* Content Action Buttons */
.content-actions {
    display: flex;
    gap: var(--spacing-xs);
    margin-left: auto;
    flex-shrink: 0;
}

.content-action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    padding: 0;
    background: transparent;
    border: none;
    border-radius: var(--radius-full);
    color: var(--ref-color-twilight-500);
    cursor: pointer;
    transition: all 0.15s ease;
}

.content-action-btn:hover {
    background: var(--ref-color-twilight-200);
    color: var(--text-primary);
}

.content-action-btn[data-action="delete"]:hover {
    background: var(--ref-color-twilight-200);
    color: var(--text-primary);
}

.content-action-btn .material-symbols-rounded {
    font-size: 18px;
}

/* Import Step Actions */
.import-step-actions {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-sm);
}

/* Import Delete Button */
.import-delete-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    padding: var(--spacing-md);
    background: var(--color-gray-200);
    border: none;
    border-radius: var(--radius-full);
    font-size: 15px;
    font-weight: 700;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.15s ease;
}

.import-delete-btn:hover {
    background: var(--ref-color-red-100);
    color: var(--ref-color-red-500);
}

.import-delete-btn.hidden {
    display: none;
}

.variant-btn {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--color-gray-50);
    border: 2px solid var(--border);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all 0.2s ease;
    width: 100%;
    text-align: left;
    box-sizing: border-box;
    -webkit-appearance: none;
    appearance: none;
}

.variant-btn:hover {
    background: var(--color-gray-100);
    border-color: var(--color-gray-300);
}

.variant-btn.active {
    background: var(--ref-color-twilight-100);
    border-color: var(--ref-color-twilight-500);
    box-shadow: 0 0 0 3px rgba(106, 92, 255, 0.15);
}

.variant-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--color-gray-200);
    border-radius: var(--radius-md);
    color: var(--text-tertiary);
    transition: all 0.2s ease;
    flex-shrink: 0;
}

.variant-icon .material-symbols-rounded {
    font-size: 20px;
}

.variant-btn:hover .variant-icon {
    color: var(--text-secondary);
}

.variant-btn.active .variant-icon {
    background: var(--ref-color-twilight-500);
    color: white;
}

.variant-letter {
    font-size: 20px;
    font-weight: 700;
    color: var(--text-tertiary);
    transition: color 0.15s ease;
}

.variant-btn.active .variant-letter {
    color: var(--ref-color-twilight-500);
}

.variant-btn-text {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 2px;
}

.variant-name {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
    text-align: left;
    letter-spacing: -0.01em;
}

.variant-desc {
    font-size: 13px;
    font-weight: 400;
    color: var(--text-tertiary);
    text-align: left;
    line-height: 1.3;
}

.variant-btn.active .variant-name {
    color: var(--ref-color-twilight-600);
}

.variant-btn.active .variant-desc {
    color: var(--ref-color-twilight-500);
}

.import-divider {
    height: 1px;
    background: var(--border);
    margin: var(--spacing-xs) 0;
}

.import-section-divider {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
    margin: var(--spacing-lg) calc(-1 * var(--spacing-xl)) var(--spacing-md);
}

.import-section-rule {
    height: 1px;
    background: var(--border);
    width: 100%;
}

.import-section-title {
    font-size: 18px;
    font-weight: 700;
    color: var(--text-primary);
    letter-spacing: -0.02em;
    margin: 0;
    padding: 0 var(--spacing-xl);
}

/* Custom scrollbar for import textarea */
.import-textarea::-webkit-scrollbar {
    width: 8px;
}

.import-textarea::-webkit-scrollbar-track {
    background: transparent;
}

.import-textarea::-webkit-scrollbar-thumb {
    background: var(--color-gray-300);
    border-radius: 4px;
}

.import-textarea::-webkit-scrollbar-thumb:hover {
    background: var(--color-gray-400);
}

@media (max-width: 640px) {
    .import-modal {
        max-height: calc(100vh - var(--spacing-lg));
        border-radius: 20px;
    }
    
    .import-modal-content {
        padding: var(--spacing-md);
    }
    
    .import-modal.layout-modal .import-modal-content {
        padding: var(--spacing-lg);
    }
    
    .import-textarea {
        height: 260px;
    }
    
    .variant-selector {
        gap: var(--spacing-xs);
    }

    .variant-btn {
        padding: var(--spacing-sm) var(--spacing-md);
    }
    
    .variant-icon {
        width: 40px;
        height: 40px;
    }
}

/* ============================================
   Design Variants
   ============================================ */

/* Option A: Default (current design) */
body.option-a {
    /* This is the default, no changes needed */
}

/* Option B: 3 Panel */

/* Color scheme for 3-panel */
body.option-b {
    background: var(--ref-color-gray-100);
    overflow: hidden;
}

body.option-b .top-nav {
    background: var(--ref-color-gray-100);
}

/* Hide default layout, show 3-panel */
body.option-b .main-content {
    display: none;
}

body.option-b .three-panel-layout {
    display: flex;
    background: var(--ref-color-gray-100);
    padding: var(--spacing-xl);
    gap: var(--spacing-sm);
    align-items: stretch;
    height: calc(100vh - 64px);
    box-sizing: border-box;
    overflow: hidden;
}

body.option-b .three-panel-layout > * {
    box-sizing: border-box;
}

/* Reorder panels for Variant B: Terms list (left), Study plan (center), Discover (right) */
body.option-b .panel-main {
    order: 1;
    flex: 1 1 33.333%;
    min-width: 240px;
    max-width: none;
}

body.option-b .panel-resize-handle[data-resize="left"] {
    order: 2;
    display: block;
}

body.option-b .panel-study-plan {
    order: 3;
    flex: 1 1 33.333%;
    min-width: 240px;
}

body.option-b .panel-resize-handle[data-resize="right"] {
    order: 4;
    display: block;
}

body.option-b .panel-discovery {
    order: 5;
    flex: 1 1 33.333%;
    min-width: 200px;
    max-width: none;
}

body.option-b .discovery-header {
    display: none;
}

body.option-b .discovery-card {
    box-shadow: 0 4px 16px rgba(0,0,0,0.08), 0 8px 32px rgba(0,0,0,0.08);
}

body.option-b .discovery-list {
    padding-right: var(--spacing-md);
    margin-right: calc(var(--spacing-md) * -1);
    overflow: visible;
}

/* Style panel-main to look like Option A sidebar */
body.option-b .panel-main {
    background: var(--surface);
    border-radius: var(--radius-xl);
    padding: 0;
}

body.option-b .panel-add-term-btn {
    margin-bottom: 0;
    margin-left: 0;
    margin-right: 0;
}

body.option-b .panel-main-header {
    padding-left: var(--spacing-lg);
    padding-right: var(--spacing-lg);
}

body.option-b .panel-main-title-row {
    flex-direction: column-reverse;
    align-items: flex-start;
    gap: var(--spacing-sm);
}

body.option-b .panel-main-actions {
    align-self: flex-start;
}

body.option-b .panel-main-actions .panel-action-btn {
    background: var(--ref-color-gray-200);
    border-radius: var(--radius-full);
}

body.option-b .panel-main-actions .panel-action-btn:hover {
    background: var(--ref-color-gray-300);
}

body.option-b .panel-study-plan {
    box-shadow: 0 4px 16px rgba(0,0,0,0.08), 0 8px 32px rgba(0,0,0,0.08);
    position: relative;
    overflow-x: hidden;
}

body.option-b .panel-study-plan::after {
    content: '';
    position: sticky;
    bottom: 0;
    left: 0;
    right: 0;
    display: block;
    width: 100%;
    height: 60px;
    margin-top: -60px;
    background: linear-gradient(to top, var(--surface) 0%, transparent 100%);
    pointer-events: none;
    border-radius: 0;
    z-index: 5;
    flex-shrink: 0;
}

body.option-b .panel-main-header {
    padding: 0;
}

body.option-b .panel-main-title {
    font-size: 24px;
    font-weight: 700;
}

body.option-b .panel-main-buttons {
    margin-top: var(--spacing-md);
}

body.option-b .panel-study-btn,
body.option-b .panel-remix-btn {
    flex: 1;
    justify-content: center;
}

body.option-b .panel-sort-filter {
    margin-top: var(--spacing-md);
    padding-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--border-default);
}

body.option-b .panel-terms-list {
    margin-top: var(--spacing-sm);
    padding-left: 0;
    padding-right: 0;
}

/* Option E: 3 Panel - AI */

body.option-e {
    background: var(--color-gray-200);
}

body.option-e .top-nav {
    background: var(--color-gray-200);
}

body.option-e .main-content {
    display: none;
}

body.option-e .three-panel-layout {
    display: flex;
    background: var(--color-gray-200);
    padding: var(--spacing-sm);
    gap: var(--spacing-sm);
}

/* Hide discovery panel and its resize handle in Variant E */
body.option-e .panel-discovery {
    display: none;
}

body.option-e .panel-resize-handle[data-resize="left"] {
    display: none;
}

/* Show AI Chat panel in Variant E */
body.option-e .ai-chat-panel {
    display: flex;
}

/* Reorder panels for Variant E: Terms list, resize, AI chat, resize, study plan */
body.option-e .panel-main {
    order: 1;
    width: 480px;
    min-width: 280px;
    flex-shrink: 0;
}

body.option-e .panel-resize-handle[data-resize="center"] {
    order: 2;
    display: block;
}

body.option-e .ai-chat-panel {
    order: 3;
    flex: 1;
    min-width: 320px;
}

body.option-e .panel-resize-handle[data-resize="right"] {
    order: 4;
}

body.option-e .panel-study-plan {
    order: 5;
    width: 280px;
    min-width: 200px;
    flex-shrink: 0;
}

/* Hide center resize handle by default (only shown in Variant E) */
.panel-resize-handle[data-resize="center"] {
    display: none;
}

/* AI Chat Panel Styles */
.ai-chat-panel {
    display: none;
    flex-direction: column;
    background: var(--surface-base);
    border-radius: var(--radius-xl);
    overflow: hidden;
    position: relative;
}

/* Top bar with menu and collapse buttons */
.ai-chat-top-bar {
    display: flex;
    justify-content: space-between;
    padding: var(--spacing-md);
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    z-index: 10;
}

.ai-chat-menu-wrapper {
    position: relative;
}

.ai-chat-menu-btn,
.ai-chat-collapse-btn {
    width: 36px;
    height: 36px;
    border-radius: var(--radius-full);
    background: transparent;
    border: none;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.ai-chat-menu-btn:hover,
.ai-chat-collapse-btn:hover {
    background: var(--color-gray-200);
}

/* More menu dropdown */
.ai-chat-menu-dropdown {
    position: absolute;
    top: calc(100% + 8px);
    left: 0;
    background: var(--surface-base);
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    min-width: 220px;
    padding: var(--spacing-xs);
    opacity: 0;
    visibility: hidden;
    transform: translateY(-8px);
    transition: all 0.2s ease;
    z-index: 100;
}

.ai-chat-menu-dropdown.active {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.ai-chat-menu-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    width: 100%;
    padding: 12px 16px;
    font-size: var(--ref-typography-size-subheading-four);
    font-weight: 600;
    background: none;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-primary);
    cursor: pointer;
    transition: background var(--transition-fast);
    text-align: left;
}

.ai-chat-menu-item:hover {
    background: var(--color-gray-100);
}

.ai-chat-menu-item .material-symbols-rounded {
    font-size: 20px;
    color: var(--text-muted);
}

/* Messages area */
.ai-chat-messages {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

/* Welcome state */
.ai-chat-welcome {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    padding: var(--spacing-xxl) var(--spacing-lg);
}

/* Gradient blur decoration */
.ai-chat-gradient-bg {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 600px;
    height: 450px;
    background: url('images/gradient-glow.png') no-repeat center center;
    background-size: contain;
    pointer-events: none;
}

.ai-chat-welcome-content {
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.ai-chat-welcome-title {
    font-size: 28px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 var(--spacing-md);
}

/* LLM Model Selector */
.llm-selector-wrapper {
    position: relative;
}

.llm-selector-btn {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: 8px 16px;
    background: transparent;
    border: none;
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 500;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.llm-selector-btn:hover {
    background: var(--color-gray-200);
    color: var(--text-primary);
}

.llm-selector-btn .material-symbols-rounded {
    font-size: 18px;
    transition: transform var(--transition-fast);
}

.llm-selector-btn.active .material-symbols-rounded {
    transform: rotate(180deg);
}

.llm-dropdown {
    position: absolute;
    top: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%) translateY(-8px);
    background: var(--surface);
    border-radius: 12px;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.12);
    min-width: 260px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    z-index: 100;
    overflow: hidden;
}

.llm-dropdown.active {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
}

.llm-dropdown-header {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border-light);
    font-size: 13px;
    color: var(--text-muted);
}

.llm-dropdown-toggles {
    padding: 8px 12px;
    border-bottom: 1px solid var(--border-light);
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.llm-toggle-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 4px;
    font-size: 14px;
    color: var(--text-primary);
    cursor: pointer;
}

.llm-toggle-item input[type="checkbox"] {
    display: none;
}

.llm-toggle-slider {
    width: 36px;
    height: 20px;
    background: var(--color-gray-300);
    border-radius: 10px;
    position: relative;
    transition: background var(--transition-fast);
}

.llm-toggle-slider::after {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    width: 16px;
    height: 16px;
    background: white;
    border-radius: 50%;
    transition: transform var(--transition-fast);
}

.llm-toggle-item input:checked + .llm-toggle-slider {
    background: var(--color-primary);
}

.llm-toggle-item input:checked + .llm-toggle-slider::after {
    transform: translateX(16px);
}

.llm-dropdown-list {
    padding: 8px;
    max-height: 280px;
    overflow-y: auto;
}

.llm-option {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: 10px 12px;
    background: none;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-primary);
    cursor: pointer;
    transition: background var(--transition-fast);
    text-align: left;
}

.llm-option:hover {
    background: var(--color-gray-100);
}

.llm-option.active {
    color: var(--text-primary);
}

.llm-option.active::after {
    content: '';
    color: var(--text-secondary);
    font-size: 14px;
}

/* Action pill buttons */
.ai-chat-action-pills {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--spacing-sm);
}

.ai-action-pill {
    position: relative;
    padding: 12px 24px;
    background: var(--surface-base);
    border: 2px solid transparent;
    border-radius: 100px 100px 2px 100px;
    font-size: 15px;
    font-weight: 500;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
    white-space: nowrap;
    background-clip: padding-box;
}

/* Gradient border effect using pseudo-element */
.ai-action-pill::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 100px 100px 2px 100px;
    padding: 2px;
    background: linear-gradient(135deg, var(--ref-color-skyblue-300) 0%, var(--twilight-400) 100%);
    -webkit-mask: 
        linear-gradient(#fff 0 0) content-box, 
        linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
}

.ai-action-pill:hover {
    background: var(--twilight-50);
    color: var(--twilight-700);
}

.ai-action-pill:hover::before {
    background: linear-gradient(135deg, var(--ref-color-skyblue-300) 0%, var(--twilight-500) 100%);
}

/* Chat messages */
.ai-message {
    display: flex;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-lg);
    padding: 0 var(--spacing-lg);
}

.ai-message.user {
    flex-direction: row-reverse;
}

.ai-message-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.ai-message.assistant .ai-message-avatar {
    background: linear-gradient(135deg, var(--twilight-100) 0%, var(--twilight-200) 100%);
}

.ai-message.assistant .ai-message-avatar .material-symbols-rounded {
    font-size: 18px;
    color: var(--twilight-600);
}

.ai-message.user .ai-message-avatar {
    background: var(--color-primary);
}

.ai-message.user .ai-message-avatar .material-symbols-rounded {
    font-size: 18px;
    color: white;
}

.ai-message-content {
    max-width: 80%;
    padding: var(--spacing-md) var(--spacing-lg);
    border-radius: var(--radius-lg);
    font-size: 14px;
    line-height: 1.5;
}

.ai-message.assistant .ai-message-content {
    background: var(--color-gray-100);
    color: var(--text-primary);
    border-bottom-left-radius: var(--radius-sm);
}

.ai-message.user .ai-message-content {
    background: var(--color-primary);
    color: white;
    border-bottom-right-radius: var(--radius-sm);
}

.ai-message-loading {
    display: flex;
    gap: 4px;
    padding: var(--spacing-md) var(--spacing-lg);
}

.ai-message-loading span {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--twilight-400);
    animation: ai-typing 1.4s infinite ease-in-out both;
}

.ai-message-loading span:nth-child(1) { animation-delay: -0.32s; }
.ai-message-loading span:nth-child(2) { animation-delay: -0.16s; }
.ai-message-loading span:nth-child(3) { animation-delay: 0s; }

@keyframes ai-typing {
    0%, 80%, 100% {
        transform: scale(0.6);
        opacity: 0.5;
    }
    40% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Chat input area */
.ai-chat-input-area {
    padding: var(--spacing-sm);
    flex-shrink: 0;
}

.ai-chat-input-wrapper {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    width: 100%;
    background: var(--surface-base);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-xl);
    padding: var(--spacing-sm);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
    box-sizing: border-box;
}

.ai-chat-input-wrapper:focus-within {
    border: 2px solid var(--ref-color-twilight-300);
    box-shadow: 0 4px 20px rgba(99, 102, 241, 0.12);
    padding: calc(var(--spacing-sm) - 1px);
}

.ai-chat-input-row {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    width: 100%;
}

/* LLM Selector inside input wrapper */
.ai-chat-input-wrapper .llm-selector-wrapper {
    margin-bottom: 0;
}

.ai-chat-input-wrapper .llm-selector-btn {
    padding: 2px 4px;
    font-size: var(--ref-typography-size-subheading-five);
    font-weight: var(--ref-typography-weight-subheader);
    color: var(--text-muted);
    gap: 2px;
}

.ai-chat-input-wrapper .llm-selector-btn:hover {
    background: transparent;
    color: var(--text-secondary);
}

.ai-chat-input-wrapper .llm-selector-btn .material-symbols-rounded {
    font-size: 14px;
}

.ai-chat-input-wrapper .llm-dropdown {
    bottom: calc(100% + 8px);
    top: auto;
    left: 0;
    transform: translateY(8px);
}

.ai-chat-input-wrapper .llm-dropdown.active {
    transform: translateY(0);
}

.ai-chat-add-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: var(--color-gray-100);
    border: none;
    color: var(--text-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-fast);
    flex-shrink: 0;
}

.ai-chat-add-btn:hover {
    background: var(--color-gray-200);
    color: var(--text-primary);
}

.ai-chat-add-btn .material-symbols-rounded {
    font-size: 20px;
}

.ai-chat-input {
    flex: 1;
    border: none;
    background: transparent;
    font-size: 15px;
    font-family: inherit;
    color: var(--text-primary);
    padding: var(--spacing-sm) 0;
    line-height: 1.5;
}

.ai-chat-input::placeholder {
    color: var(--text-muted);
}

.ai-chat-input:focus {
    outline: none;
}

.ai-chat-send-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--twilight-500);
    border: none;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-fast);
    flex-shrink: 0;
}

.ai-chat-send-btn:disabled {
    background: var(--color-gray-200);
    cursor: not-allowed;
}

.ai-chat-send-btn:not(:disabled):hover {
    background: var(--twilight-600);
    transform: scale(1.05);
}

.ai-chat-send-btn .material-symbols-rounded {
    font-size: 20px;
}

.ai-chat-enhanced {
    font-size: 12px;
    color: var(--text-muted);
    margin: var(--spacing-sm) 0 0;
    text-align: center;
}

/* 3-Panel Layout Container */
.three-panel-layout {
    display: none;
    height: calc(100vh - 64px - var(--spacing-sm) * 2);
    overflow: hidden;
}

/* Panel Resize Handles */
.panel-resize-handle {
    width: 6px;
    background: transparent;
    cursor: col-resize;
    position: relative;
    flex-shrink: 0;
    z-index: 10;
    transition: background 0.15s ease,
                width 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.3s ease;
}

.panel-resize-handle::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 4px;
    height: 40px;
    background: var(--color-gray-300);
    border-radius: 2px;
    opacity: 0;
    transition: opacity 0.15s ease;
}

.panel-resize-handle:hover {
    background: var(--color-gray-300);
}

.panel-resize-handle:hover::after {
    opacity: 1;
}

.panel-resize-handle.dragging {
    background: var(--color-primary);
}

.panel-resize-handle.dragging::after {
    opacity: 1;
    background: white;
}

/* Prevent text selection while resizing */
body.resizing {
    cursor: col-resize !important;
    user-select: none;
}

body.resizing * {
    cursor: col-resize !important;
}

/* Panel 1: Discovery */
.panel-discovery {
    width: 320px;
    min-width: 200px;
    flex-shrink: 0;
    background: transparent;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.three-panel-layout.study-expanded .panel-discovery {
    display: none;
    width: 0;
    min-width: 0;
    max-width: 0;
    opacity: 0;
    padding: 0;
    margin: 0;
    overflow: hidden;
    pointer-events: none;
}

.discovery-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-sm) var(--spacing-md);
}

.discovery-title {
    font-size: 16px;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
}

.discovery-refresh-btn {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-full);
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.discovery-refresh-btn:hover {
    background: var(--color-gray-300);
    color: var(--color-primary);
}

.discovery-refresh-btn.loading .material-symbols-rounded {
    animation: spin 1s linear infinite;
}

.discovery-tabs {
    display: flex;
    gap: 4px;
    padding: 0 var(--spacing-sm) var(--spacing-sm);
    overflow-x: auto;
    flex-shrink: 0;
}

.discovery-tabs::-webkit-scrollbar {
    display: none;
}

.discovery-tab {
    padding: 8px 16px;
    background: var(--color-gray-200);
    border: none;
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    white-space: nowrap;
    transition: all var(--transition-fast);
}

.discovery-tab:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.discovery-tab.active {
    background: transparent;
    border: 2px solid var(--text-secondary);
    color: var(--text-secondary);
    padding: 6px 14px; /* Adjust for border */
}

.discovery-tab.loading {
    position: relative;
    overflow: hidden;
    background: var(--color-gray-200);
    color: transparent;
}

.discovery-tab.loading::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        var(--color-gray-300) 50%,
        transparent 100%
    );
    animation: shimmer 1.5s infinite;
}

.discovery-list {
    flex: 1;
    overflow-y: auto;
    padding: 0 var(--spacing-sm) var(--spacing-sm);
}

.discovery-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-xl);
    color: var(--text-muted);
    font-size: 13px;
}

/* Discovery Loading Skeleton */
.discovery-loading-skeleton {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.discovery-loading-spinner {
    width: 24px;
    height: 24px;
    border: 3px solid var(--color-gray-300);
    border-top-color: var(--color-primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

/* Enhanced Discovery Card */
.discovery-card {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    background: var(--surface-base);
    border-radius: var(--radius-lg);
    margin-bottom: var(--spacing-sm);
    cursor: pointer;
    transition: all var(--transition-fast);
    border: 2px solid transparent;
}

.discovery-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-card);
}

.discovery-card.active {
    border-color: var(--color-primary);
}

.discovery-card-header {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
}

.discovery-icon {
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-md);
    flex-shrink: 0;
}

.discovery-icon.biology {
    background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%);
    color: #059669;
}

.discovery-icon.chemistry {
    background: linear-gradient(135deg, #DBEAFE 0%, #BFDBFE 100%);
    color: #2563EB;
}

.discovery-icon.psychology {
    background: linear-gradient(135deg, #F3E8FF 0%, #E9D5FF 100%);
    color: #9333EA;
}

.discovery-icon.anatomy {
    background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%);
    color: #DC2626;
}

.discovery-icon.default {
    background: var(--color-gray-200);
    color: var(--text-secondary);
}

.discovery-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.discovery-card-title {
    font-size: 14px;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 1.3;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.discovery-card-author {
    font-size: 12px;
    color: var(--text-muted);
    display: flex;
    align-items: center;
    gap: 4px;
}

.discovery-card-author .material-symbols-rounded {
    font-size: 14px;
}

.discovery-card-meta {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    flex-wrap: wrap;
}

.discovery-meta-item {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
}

.discovery-meta-item .material-symbols-rounded {
    font-size: 14px;
}

.discovery-meta-item .material-symbols-rounded.filled {
    color: var(--color-sunset);
}

.discovery-meta-badge {
    padding: 2px 8px;
    background: rgba(16, 185, 129, 0.1);
    border-radius: var(--radius-full);
    font-size: 10px;
    font-weight: 700;
    color: #059669;
    text-transform: uppercase;
}

.discovery-card-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-top: var(--spacing-xs);
    border-top: 1px solid var(--border-default);
}

.discovery-studiers {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 11px;
    color: var(--text-muted);
}

.discovery-studiers .material-symbols-rounded {
    font-size: 14px;
}

.discovery-preview-btn {
    padding: 4px 10px;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    font-size: 11px;
    font-weight: 600;
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.discovery-preview-btn:hover {
    background: var(--color-primary);
    color: white;
}

/* Panel 2: Main Content */
.panel-main {
    flex: 1;
    min-width: 280px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: var(--surface-base);
    border-radius: var(--radius-xl);
}

.panel-main-header {
    padding: var(--spacing-sm) var(--spacing-md);
    padding-bottom: var(--spacing-xs);
    flex-shrink: 0;
}

.panel-main-title-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-xs);
}

.panel-main-title {
    font-size: 24px;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
}

.panel-main-actions {
    display: flex;
    gap: var(--spacing-xs);
}

.panel-action-btn {
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.panel-action-btn:hover {
    background: var(--color-gray-200);
}

.panel-main-meta {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

/* Progress View (shown when study is expanded) */
.panel-progress-view {
    display: none;
    flex-direction: column;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
}

.panel-progress-bar {
    width: 100%;
    height: 4px;
    background: var(--color-mint-100);
    border-radius: var(--radius-full);
    overflow: visible;
    position: relative;
}

.panel-progress-fill {
    height: 100%;
    background: var(--color-mint-500);
    border-radius: var(--radius-full);
    transition: width 0.3s ease;
    width: 0%;
    position: relative;
    min-width: 4px;
}

/* Placeholder circle at start of empty progress bar */
.panel-progress-fill::after {
    content: '';
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    height: 4px;
    background: var(--color-mint-500);
    border-radius: 50%;
}

.panel-progress-text {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-secondary);
}

/* Hide/Show elements based on progress view state */
.three-panel-layout.study-expanded .hide-in-progress {
    display: none !important;
}

.three-panel-layout.study-expanded .show-in-progress {
    display: flex !important;
}

/* Hide audio and star buttons in term rows during progress view */
.three-panel-layout.study-expanded .panel-term-audio,
.three-panel-layout.study-expanded .panel-term-star {
    display: none;
}

/* Term Progress Indicators */
.panel-term-progress {
    display: none;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    flex-shrink: 0;
}

.panel-term-progress .material-symbols-rounded {
    font-size: 20px;
}

.panel-term-progress .material-symbols-rounded.learning {
    color: var(--color-gray-300);
}

.panel-term-progress .material-symbols-rounded.known {
    color: var(--color-success);
}

.panel-term-progress .material-symbols-rounded.known.filled {
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
}

.panel-term-progress.known {
    animation: progressPop 0.3s ease;
}

@keyframes progressPop {
    0% { transform: scale(1); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); }
}

.panel-meta-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
}

.panel-meta-item .material-symbols-rounded {
    font-size: 22px;
    color: var(--text-secondary);
}

.panel-meta-avatar {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    object-fit: cover;
}

.panel-meta-item .material-symbols-rounded.filled {
    color: var(--color-sunset);
}

/* Study & Remix Buttons */
.panel-main-buttons {
    display: flex;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
}

.panel-study-btn,
.panel-remix-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 12px 24px;
    border-radius: var(--radius-full);
    font-size: 15px;
    font-weight: 700;
    transition: all var(--transition-fast);
}

.panel-study-btn {
    background: var(--color-primary);
    color: white;
}

.panel-study-btn:hover {
    background: var(--color-primary-hover);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(66, 85, 255, 0.3);
}

.panel-remix-btn {
    background: var(--ref-color-twilight-100);
    color: var(--color-primary);
}

.panel-remix-btn:hover {
    background: var(--ref-color-twilight-200);
}

.panel-study-btn .material-symbols-rounded,
.panel-remix-btn .material-symbols-rounded {
    font-size: 20px;
}

.panel-main-toggle {
    display: inline-flex;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    padding: 4px;
}

.panel-toggle-btn {
    padding: 8px 20px;
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

/* Panel Sort & Filter Controls */
.panel-sort-filter {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 0;
    margin-bottom: var(--spacing-xs);
}

.panel-control-btn {
    display: flex;
    align-items: center;
    gap: var(--spacing-xxs);
    padding: 0;
    background: none;
    border: none;
    border-radius: 0;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.panel-control-btn:hover {
    background: none;
    color: var(--text-primary);
}

.panel-control-btn.active {
    background: none;
    color: var(--color-primary);
}

.panel-control-btn .material-symbols-rounded {
    font-size: 16px;
}

.panel-empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-xl);
    text-align: center;
    color: var(--text-secondary);
}

.panel-empty-state .material-symbols-rounded {
    font-size: 48px;
    margin-bottom: var(--spacing-sm);
    opacity: 0.5;
}

.panel-empty-state p {
    font-size: 14px;
    font-weight: 500;
    margin: 0;
}

.panel-toggle-btn.active {
    background: var(--surface-base);
    color: var(--text-primary);
    box-shadow: var(--shadow-sm);
}

.panel-terms-list {
    flex: 1;
    overflow-y: auto;
    padding: var(--spacing-sm) var(--spacing-lg);
}

/* Panel Topic Sections (Grouped View) */
.panel-topic-section {
    margin-bottom: var(--spacing-sm);
}

.panel-topic-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--color-gray-200);
    border-radius: var(--radius-lg);
    cursor: pointer;
    user-select: none;
    transition: background var(--transition-fast);
}

.panel-topic-header:hover {
    background: var(--color-gray-300);
}

/* Progress ring for concept groups */
.group-progress-ring {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
}

.group-progress-ring svg {
    display: block;
}

.progress-ring-bg {
    stroke: var(--color-gray-300);
}

.progress-ring-fill {
    stroke: var(--color-mint-200);
    stroke-linecap: round;
    transition: stroke-dashoffset 0.3s ease;
}

.panel-topic-title {
    flex: 1;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
}

.panel-topic-toggle {
    font-size: 20px;
    color: var(--text-secondary);
    transition: transform var(--transition-fast);
}

.panel-topic-section.collapsed .panel-topic-toggle {
    transform: rotate(-90deg);
}

.panel-topic-cards {
    display: flex;
    flex-direction: column;
}

.panel-topic-section.collapsed .panel-topic-cards {
    display: none;
}

.panel-term-row {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    border-bottom: 1px solid var(--border-default);
    cursor: pointer;
    transition: background var(--transition-fast);
}

.panel-term-row:hover {
    background: var(--color-gray-200);
}

.panel-term-row:last-child {
    border-bottom: none;
}

.panel-term-audio {
    color: var(--text-muted);
    transition: color var(--transition-fast);
}

.panel-term-audio:hover {
    color: var(--color-primary);
}

.panel-term-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.panel-term-term {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
}

.panel-term-definition {
    font-size: 15px;
    color: var(--text-secondary);
}

.panel-term-star {
    color: var(--text-muted);
    transition: color var(--transition-fast);
}

.panel-term-star:hover {
    color: var(--color-sunset);
}

.panel-term-star.starred {
    color: var(--color-sunset);
}

.panel-term-star.starred .material-symbols-rounded {
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24 !important;
}

/* Panel Term Actions (audio + star grouped on right) */
.panel-term-actions {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-xs);
    flex-shrink: 0;
}

/* Panel Term Status (progress icon on left) */
.panel-term-status {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    flex-shrink: 0;
}

.panel-term-status.known {
    background: var(--color-mint-100);
}

.panel-term-status.known .material-symbols-rounded {
    color: var(--color-mint-500);
    font-size: 24px;
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
}

.panel-term-status.learning {
    background: var(--color-gray-200);
}

.panel-term-status.learning .material-symbols-rounded {
    color: var(--color-gray-400);
    font-size: 24px;
}

/* Panel Concept Sections (Variant E) - Pill Button Style */
.panel-concept-section {
    margin-bottom: var(--spacing-sm);
}

.panel-concept-section:last-child {
    margin-bottom: 0;
}

.panel-concept-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    cursor: pointer;
    transition: all var(--transition-fast);
    height: 56px;
}

.panel-concept-header:hover {
    background: var(--color-gray-300);
}

.panel-concept-header-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    flex: 1;
}

.panel-concept-progress-ring {
    width: 36px;
    height: 36px;
    flex-shrink: 0;
    position: relative;
}

.panel-concept-progress-ring svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.panel-concept-progress-ring .progress-ring-bg {
    fill: none;
    stroke: var(--color-gray-300);
    stroke-width: 3;
}

.panel-concept-progress-ring .progress-ring-fill {
    fill: none;
    stroke: var(--color-mint-200);
    stroke-width: 3;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.3s ease;
}

.panel-concept-progress-ring .progress-ring-check {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 18px;
    color: var(--color-mint-500);
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
}

.panel-concept-title {
    font-size: 16px;
    font-weight: 600;
    line-height: 1.4;
    color: var(--text-secondary);
    margin: 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}


.panel-concept-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    color: var(--text-secondary);
    transition: transform 0.25s ease;
    flex-shrink: 0;
}

.panel-concept-section.collapsed .panel-concept-toggle {
    transform: rotate(-90deg);
}

.panel-concept-cards {
    background: transparent;
    border-radius: 0;
    padding: 0;
    margin-top: 0;
}

.panel-concept-section.collapsed .panel-concept-cards {
    display: none;
}

.panel-add-term-btn {
    margin: var(--spacing-sm) var(--spacing-lg) var(--spacing-lg);
    padding: var(--spacing-sm) var(--spacing-md);
    border: 2px dashed var(--ref-color-twilight-100);
    border-radius: 200px;
    color: var(--color-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs);
    font-size: 14px;
    font-weight: 600;
    transition: all var(--transition-fast);
}

.panel-add-term-btn .material-symbols-rounded {
    font-size: 20px;
    color: var(--color-primary);
}

.panel-add-term-btn:hover {
    border-color: var(--color-primary);
    background: var(--ref-color-twilight-100);
}

/* Panel 3: Study Plan */
.panel-study-plan {
    width: 280px;
    min-width: 200px;
    flex-shrink: 0;
    background: var(--surface-base);
    border-radius: var(--radius-xl);
    padding: var(--spacing-md);
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: flex-start;
    gap: var(--spacing-sm);
    overflow-y: auto;
}

/* Expanded study mode - 2 column layout (30% / 70%) */
.three-panel-layout.study-expanded {
    padding: var(--spacing-sm);
    gap: var(--spacing-sm);
}

.three-panel-layout.study-expanded .panel-resize-handle[data-resize="left"] {
    display: none;
}

.three-panel-layout.study-expanded .panel-main {
    flex: 0 0 30%;
    width: 30%;
    min-width: 280px;
    transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
}

.three-panel-layout.study-expanded .panel-resize-handle[data-resize="right"] {
    display: none;
}

.three-panel-layout.study-expanded .panel-study-plan {
    flex: 1;
    width: 70%;
    min-width: 0;
    max-width: none;
    transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Study plan default vs expanded views */
.study-plan-default {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    opacity: 1;
    transition: opacity 0.2s ease;
    flex-shrink: 0;
    height: auto;
    padding-bottom: var(--spacing-xs);
}

.three-panel-layout.study-expanded .study-plan-default {
    display: none;
    opacity: 0;
}

.study-experience {
    display: flex;
    flex-direction: column;
    height: 100%;
    opacity: 0;
    visibility: hidden;
    transform: translateX(20px);
    transition: opacity 0.35s ease 0.15s, 
                transform 0.35s ease 0.15s,
                visibility 0s ease 0.5s;
}

.three-panel-layout.study-expanded .study-experience {
    opacity: 1;
    visibility: visible;
    transform: translateX(0);
    transition: opacity 0.35s ease 0.15s, 
                transform 0.35s ease 0.15s,
                visibility 0s ease 0s;
}

.study-plan-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.study-plan-title {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    margin: 0;
}

.study-plan-settings {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-md);
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.study-plan-settings:hover {
    background: var(--color-gray-200);
    color: var(--text-secondary);
}

.study-plan-settings .material-symbols-rounded {
    font-size: 20px;
}

.study-plan-timeline {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    position: relative;
    padding-left: 20px;
}

.study-plan-timeline::before {
    content: '';
    position: absolute;
    left: 5px;
    top: 20px;
    bottom: 20px;
    width: 2px;
    background: var(--color-gray-300);
    border-radius: 1px;
}

.study-plan-item {
    position: relative;
}

.study-plan-dot {
    position: absolute;
    left: -20px;
    top: 50%;
    transform: translateY(-50%);
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--surface-base);
    border: 2px solid var(--color-gray-300);
    z-index: 1;
}

.study-plan-item.recommended .study-plan-dot {
    background: var(--color-primary);
    border-color: var(--color-primary);
    box-shadow: 0 0 0 4px rgba(66, 85, 255, 0.2);
}

/* Study Action Cards */
.study-action-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.study-action-card:hover {
    transform: translateX(2px);
}

.study-action-label {
    font-size: 15px;
    font-weight: 700;
    color: var(--text-primary);
}

.study-action-icon {
    display: flex;
    align-items: center;
    gap: 4px;
}

.study-action-icon .material-symbols-rounded {
    font-size: 20px;
}

.study-action-icon .material-symbols-rounded:last-child {
    font-size: 18px;
    color: var(--text-muted);
}

/* Flashcards - Featured/Recommended */
.study-action-flashcards {
    background: linear-gradient(135deg, #E8F4FC 0%, #D4ECFB 100%);
    flex-direction: column;
    align-items: stretch;
    padding: var(--spacing-md);
    gap: var(--spacing-sm);
}

.study-action-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.study-action-cta {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 6px 12px;
    background: var(--color-primary);
    border-radius: var(--radius-full);
    color: white;
    font-size: 12px;
    font-weight: 600;
}

.study-action-cta .material-symbols-rounded {
    font-size: 16px;
}

.study-action-illustration {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-md) 0;
}

.illustration-cards {
    position: relative;
    width: 80px;
    height: 60px;
}

.illus-card {
    position: absolute;
    border-radius: var(--radius-md);
}

.illus-card-back {
    width: 50px;
    height: 40px;
    background: linear-gradient(135deg, #7C8CFF 0%, #5B6BE6 100%);
    top: 0;
    right: 0;
    transform: rotate(8deg);
}

.illus-card-front {
    width: 55px;
    height: 45px;
    background: linear-gradient(135deg, #4255FF 0%, #3347CC 100%);
    bottom: 0;
    left: 0;
    transform: rotate(-5deg);
    box-shadow: 0 4px 12px rgba(66, 85, 255, 0.3);
}

/* Learn */
.study-action-learn {
    background: linear-gradient(135deg, #E8F9F4 0%, #D4F3EB 100%);
}

.study-action-learn .material-symbols-rounded:first-child {
    color: #10B981;
}

/* Games */
.study-action-games {
    background: linear-gradient(135deg, #E8F4FC 0%, #D4ECFB 100%);
}

.study-action-games .material-symbols-rounded:first-child {
    color: #0EA5E9;
}

/* Test */
.study-action-test {
    background: linear-gradient(135deg, #EEF2FF 0%, #E0E7FF 100%);
}

.study-action-test .material-symbols-rounded:first-child {
    color: var(--color-primary);
}

/* Section Label */
.study-plan-section-label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-muted);
    margin-top: var(--spacing-sm);
    padding-left: 20px;
}

/* Exam Day Header */
.exam-day-header {
    margin-top: var(--spacing-md);
}

/* Exam Day Timeline */
.exam-day-timeline {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    position: relative;
    padding-left: 20px;
}

.exam-day-timeline::before {
    content: '';
    position: absolute;
    left: 5px;
    top: 20px;
    bottom: 20px;
    width: 2px;
    background: repeating-linear-gradient(
        to bottom,
        var(--color-gray-300) 0px,
        var(--color-gray-300) 8px,
        transparent 8px,
        transparent 14px
    );
    border-radius: 1px;
}

.exam-day-item {
    position: relative;
}

.exam-day-dot {
    position: absolute;
    left: -20px;
    top: 50%;
    transform: translateY(-50%);
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--surface-base);
    border: 2px solid var(--color-gray-300);
    z-index: 1;
}

/* Cheat Sheet */
.study-action-cheatsheet {
    background: linear-gradient(135deg, #FDF2F8 0%, #FCE7F3 100%);
}

.study-action-cheatsheet .material-symbols-rounded:first-child {
    color: #EC4899;
}

/* Podcast */
.study-action-podcast {
    background: linear-gradient(135deg, #F3E8FF 0%, #E9D5FF 100%);
}

.study-action-podcast .material-symbols-rounded:first-child {
    color: #A855F7;
}

/* Video Overview */
.study-action-video {
    background: linear-gradient(135deg, #E0F2FE 0%, #BAE6FD 100%);
}

.study-action-video .material-symbols-rounded:first-child {
    color: #0EA5E9;
}

/* Pre-test Meditation */
.study-action-meditation {
    background: linear-gradient(135deg, #ECFDF5 0%, #D1FAE5 100%);
}

.study-action-meditation .material-symbols-rounded:first-child {
    color: #10B981;
}

/* Study Experience (Expanded View) */
.study-experience-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
}

/* Experience Tabs (Segmented Controller) */
.experience-tabs {
    display: flex;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    padding: 4px;
    gap: 2px;
}

.experience-tab-btn {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    background: transparent;
    border: none;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.experience-tab-btn:hover {
    color: var(--text-primary);
}

.experience-tab-btn.active {
    background: var(--surface-base);
    color: var(--text-primary);
    box-shadow: var(--shadow-card);
}

.experience-tab-btn .material-symbols-rounded {
    font-size: 18px;
}

.study-close-btn {
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.study-close-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.study-close-btn .material-symbols-rounded {
    font-size: 20px;
}

.study-experience-title {
    font-size: 18px;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
}

.study-experience-progress {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-muted);
    background: var(--color-gray-200);
    padding: 6px 14px;
    border-radius: var(--radius-full);
}

.study-experience-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-lg);
}

/* Experience Flashcard */
.experience-flashcard-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-lg);
    width: 100%;
    max-width: 600px;
}

.experience-flashcard-stack {
    width: 100%;
    position: relative;
    perspective: 1000px;
}

/* Background card (stacked effect) */
.experience-flashcard-bg {
    position: absolute;
    top: 12px;
    left: 8px;
    right: 8px;
    height: 320px;
    background: var(--surface-raised);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-card);
    opacity: 0.6;
    z-index: 0;
}

.experience-flashcard {
    width: 100%;
    height: 320px;
    cursor: pointer;
    position: relative;
    z-index: 1;
}

.experience-flashcard-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    transform-style: preserve-3d;
}

.experience-flashcard.flipped .experience-flashcard-inner {
    transform: rotateX(180deg);
}

.experience-flashcard-front,
.experience-flashcard-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    background: var(--surface-raised);
    border-radius: var(--radius-xl);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-xl);
    box-shadow: var(--shadow-card);
    border: 1px solid var(--border-default);
}

.experience-flashcard-back {
    transform: rotateX(180deg);
    background: var(--surface-raised);
}

.experience-flashcard-text {
    font-size: 24px;
    font-weight: 600;
    text-align: center;
    color: var(--text-primary);
    line-height: 1.4;
}

/* Card change animation */
.experience-flashcard.animate-change {
    animation: experienceCardChange 0.3s ease;
}

@keyframes experienceCardChange {
    0% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.8;
        transform: scale(0.98);
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}

/* Experience Controls */
.experience-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    max-width: 600px;
}

.experience-controls-left,
.experience-controls-right {
    display: flex;
    align-items: center;
}

.experience-controls-center {
    display: flex;
    align-items: center;
    gap: var(--spacing-lg);
}

.experience-control-btn {
    width: 56px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

/* Shuffle and Fullscreen are smaller icon buttons */
.experience-control-btn#experience-shuffle-btn,
.experience-control-btn#experience-fullscreen-btn {
    width: 48px;
    height: 48px;
}

.experience-control-btn#experience-shuffle-btn .material-symbols-rounded,
.experience-control-btn#experience-fullscreen-btn .material-symbols-rounded {
    font-size: 22px;
}

.experience-control-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
    transform: scale(1.05);
}

.experience-control-btn.star:hover {
    color: var(--color-sunset);
}

.experience-control-btn.star.starred {
    color: var(--color-sunset);
}

.experience-control-btn.star.starred .material-symbols-rounded {
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24 !important;
}

.experience-control-btn .material-symbols-rounded {
    font-size: 28px;
}

/* Experience Actions */
.experience-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.experience-action-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 10px 18px;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    font-size: 13px;
    font-weight: 600;
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.experience-action-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.experience-action-btn .material-symbols-rounded {
    font-size: 18px;
}

/* Option C: Journey */
body.option-c {
    background: var(--surface-base);
}

body.option-c .top-nav {
    background: var(--surface-base);
}

body.option-c .main-content {
    display: none;
}

body.option-c .journey-layout {
    display: flex;
}

/* Hide the journey-terms-panel and show sidebar in Variant C */
body.option-c .journey-terms-panel {
    display: none;
}

body.option-c .journey-sidebar {
    display: block;
}

/* Journey Sidebar (exact mirror of Variant A .sidebar) */
.journey-sidebar {
    display: none;
    flex: 1;
    max-width: 900px;
    overflow-y: auto;
    max-height: calc(100vh - 64px - var(--spacing-xl));
    position: sticky;
    bottom: 0;
    align-self: flex-end;
    background: var(--surface);
    padding: 40px 56px;
    padding-bottom: 80px;
    border-radius: 32px 32px 0 0;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06), 0 1px 4px rgba(0, 0, 0, 0.04);
}

/* Spacing between topics list and about section */
.journey-sidebar .journey-topics-container {
    margin-bottom: 32px;
}

/* Creator info layout in journey sidebar */
.journey-sidebar .creator-info {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.journey-sidebar .creator-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
}

.journey-sidebar .creator-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.journey-sidebar .creator-details {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.journey-sidebar .creator-name {
    font-size: 14px;
    color: var(--text-secondary);
}

.journey-sidebar .creator-name strong {
    color: var(--text-primary);
    font-weight: 600;
}

.journey-sidebar .creator-badge {
    font-size: 13px;
    color: var(--text-muted);
}

.journey-sidebar::-webkit-scrollbar {
    width: 6px;
}

.journey-sidebar::-webkit-scrollbar-track {
    background: transparent;
}

.journey-sidebar::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 3px;
}

.journey-sidebar::-webkit-scrollbar-thumb:hover {
    background: var(--text-muted);
}

/* Journey Sidebar Sort/Filter as links */
.journey-sidebar .toc-control-btn {
    padding: 0;
    background: transparent;
    border-radius: 0;
}

.journey-sidebar .toc-control-btn:hover {
    background: transparent;
    color: var(--text-primary);
}

/* Journey Action Buttons Layout */
.journey-action-buttons {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
}

.journey-action-buttons .action-buttons-left {
    display: flex;
    gap: var(--spacing-sm);
}

.journey-action-buttons .action-buttons-right {
    display: flex;
    gap: var(--spacing-xs);
}

/* Journey Sidebar Metadata List (mirrors Variant A) */
.journey-sidebar .metadata-list {
    display: flex;
    flex-direction: column;
    gap: 0;
}

.journey-sidebar .metadata-item {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-md);
    padding: var(--spacing-lg) 0;
    border-top: 1px solid var(--border-default);
}

.journey-sidebar .metadata-item:last-child {
    padding-bottom: 0;
}

.journey-sidebar .metadata-icon {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-secondary);
    flex-shrink: 0;
    font-size: 22px;
}

.journey-sidebar .metadata-icon.metadata-icon-text {
    font-size: 16px;
    font-weight: 700;
    color: var(--text-secondary);
}

.journey-sidebar .metadata-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.journey-sidebar .metadata-label {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
}

.journey-sidebar .metadata-value {
    font-size: 14px;
    color: var(--text-secondary);
    font-weight: 400;
    line-height: 1.4;
}

/* Journey Sidebar About Section (mirrors Variant A) */
.journey-sidebar .about-section {
    margin-top: var(--spacing-xl);
}

.journey-sidebar .about-title {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    margin: 0 0 var(--spacing-sm) 0;
    letter-spacing: 0.01em;
}

.journey-sidebar .about-description {
    font-size: 15px;
    color: var(--text-primary);
    line-height: 1.5;
    margin: 0 0 var(--spacing-lg) 0;
}

/* Journey Sidebar Term Card Active State */
.journey-sidebar .term-card {
    margin: 0 calc(var(--spacing-sm) * -1);
    padding-left: var(--spacing-sm);
    padding-right: var(--spacing-sm);
    border-radius: var(--radius-lg);
    transition: background var(--transition-fast), padding var(--transition-fast);
}

.journey-sidebar .term-card.active {
    background: var(--color-gray-200);
    padding: var(--spacing-md);
    margin: var(--spacing-xs) calc(var(--spacing-md) * -1);
    border-bottom: 1px solid transparent;
}

/* Journey Layout Container */
.journey-layout {
    display: none;
    height: calc(100vh - 64px);
    max-width: 1366px;
    margin: 0 auto;
    padding: var(--spacing-xl) 100px 0;
    gap: var(--spacing-xl);
    background: var(--surface-base);
}

/* Journey Terms Panel (Left) */
.journey-terms-panel {
    width: 480px;
    min-width: 380px;
    background: var(--surface-base);
    border-radius: var(--radius-xl);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.journey-header {
    padding: var(--spacing-lg);
    padding-bottom: var(--spacing-sm);
    flex-shrink: 0;
}

.journey-title {
    font-size: 28px;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0 0 var(--spacing-sm);
}

.journey-meta {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

.journey-meta-item {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-secondary);
}

.journey-meta-item .material-symbols-rounded {
    font-size: 18px;
}

.journey-meta-item.trending {
    color: var(--color-magenta);
}

.journey-meta-item.trending .material-symbols-rounded {
    color: var(--color-magenta);
}

.journey-meta-item.rating .material-symbols-rounded.star-icon {
    color: var(--color-sunset);
    font-variation-settings: 'FILL' 1;
}

/* Journey Secondary Actions */
.journey-secondary-actions {
    display: flex;
    gap: var(--spacing-sm);
    padding: 0 var(--spacing-lg);
    margin-bottom: var(--spacing-sm);
}

/* Journey Actions */
.journey-actions {
    display: flex;
    gap: var(--spacing-sm);
    padding: 0 var(--spacing-lg);
    margin-bottom: var(--spacing-md);
}

.journey-study-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 18px;
    background: var(--color-primary);
    color: white;
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    transition: all var(--transition-fast);
}

.journey-study-btn:hover {
    background: var(--color-primary-hover);
}

.journey-study-btn .material-symbols-rounded {
    font-size: 18px;
}

.journey-remix-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 18px;
    background: var(--twilight-100);
    color: var(--twilight-500);
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    transition: all var(--transition-fast);
}

.journey-remix-btn:hover {
    background: var(--twilight-200);
}

.journey-remix-btn .material-symbols-rounded {
    font-size: 18px;
}

.journey-action-btn {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.journey-action-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.journey-action-btn .material-symbols-rounded {
    font-size: 20px;
}

/* Journey Sort/Filter Controls */
.journey-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-sm) var(--spacing-lg);
    border-bottom: 1px solid var(--border-light);
}

.journey-sort-btn,
.journey-filter-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 0;
    background: transparent;
    border: none;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
    cursor: pointer;
    transition: color var(--transition-fast);
}

.journey-sort-btn:hover,
.journey-filter-btn:hover {
    color: var(--text-primary);
}

.journey-sort-btn .material-symbols-rounded,
.journey-filter-btn .material-symbols-rounded {
    font-size: 18px;
}

.journey-terms-list {
    flex: 1;
    overflow-y: auto;
    padding: 0;
}

.journey-section {
    margin-bottom: var(--spacing-xs);
}

.journey-section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--surface-base);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.journey-section-header:hover {
    background: var(--color-gray-200);
}

.journey-section.expanded .journey-section-header {
    border-radius: var(--radius-lg) var(--radius-lg) 0 0;
    border-bottom: none;
}

.journey-section-title {
    font-size: 15px;
    font-weight: 700;
    color: var(--text-primary);
}

.journey-section-toggle {
    color: var(--text-muted);
    transition: transform 0.2s ease;
}

.journey-section.expanded .journey-section-toggle {
    transform: rotate(180deg);
}

.journey-section-content {
    display: none;
    border: 1px solid var(--border-default);
    border-top: none;
    border-radius: 0 0 var(--radius-lg) var(--radius-lg);
    overflow: hidden;
}

.journey-section.expanded .journey-section-content {
    display: block;
}

.journey-term-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-lg);
    padding: var(--spacing-md);
    border-bottom: 1px solid var(--border-default);
    cursor: pointer;
    transition: background var(--transition-fast);
}

.journey-term-row:hover {
    background: var(--color-gray-200);
}

.journey-term-row.active {
    background: rgba(66, 85, 255, 0.08);
    border-left: 3px solid var(--color-primary);
}

.journey-term-row:last-child {
    border-bottom: none;
}

.journey-term-text {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
}

.journey-term-def {
    font-size: 14px;
    color: var(--text-secondary);
}

.journey-add-btn {
    margin: var(--spacing-sm);
    padding: var(--spacing-md);
    border: 2px dashed var(--border-default);
    border-radius: var(--radius-lg);
    color: var(--text-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-fast);
    flex-shrink: 0;
}

.journey-add-btn:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
    background: rgba(66, 85, 255, 0.05);
}

/* Journey Map Panel (Right) */
.journey-map-panel {
    flex: 1;
    max-width: 620px;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    overflow: visible;
    padding: var(--spacing-xl) var(--spacing-xl) 0;
}

.journey-map {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
    padding: var(--spacing-xl) 0 0;
    width: 100%;
    max-width: 620px;
    overflow: visible;
}

/* Journey Node */
.journey-node {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-lg);
    position: relative;
    transition: transform 0.2s ease;
}

/* Zigzag offset pattern */
.journey-node:nth-child(odd) {
    transform: translateX(-50px);
}

.journey-node:nth-child(even) {
    transform: translateX(50px);
}

.journey-node:first-child {
    transform: translateX(0);
}

.journey-node-main {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
    padding-bottom: 80px;
    position: relative;
}

/* Start Label - Coachmark style */
.journey-start-label {
    position: absolute;
    top: -55px;
    left: 50%;
    transform: translateX(-50%);
    padding: 12px 24px;
    background: var(--color-gray-800);
    border-radius: var(--radius-lg);
    font-size: 14px;
    font-weight: 600;
    color: white;
    z-index: 20;
    letter-spacing: 0.2px;
    white-space: nowrap;
    animation: bounce-gentle 2s ease-in-out infinite;
}

/* Triangle pointer */
.journey-start-label::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid var(--color-gray-800);
}

@keyframes bounce-gentle {
    0%, 100% {
        transform: translateX(-50%) translateY(0);
    }
    50% {
        transform: translateX(-50%) translateY(-6px);
    }
}

/* 3D Node Container */
.journey-node-3d {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    transition: transform 0.2s ease;
    flex-shrink: 0;
    width: 82px;
    min-width: 82px;
}

.journey-node-3d:hover {
    transform: translateY(-4px);
}

/* Progress Ring (for all nodes) - Uses mint color, SVG-based */
.journey-node-progress-ring {
    position: absolute;
    width: 82px;
    height: 82px;
    min-width: 82px;
    min-height: 82px;
    z-index: 4;
    aspect-ratio: 1;
    flex-shrink: 0;
}

.journey-node-progress-ring svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.journey-node-progress-ring .progress-ring-bg {
    fill: none;
    stroke: var(--color-gray-300);
    stroke-width: 4;
}

.journey-node-progress-ring .progress-ring-fill {
    fill: none;
    stroke: var(--color-mint-200);
    stroke-width: 4;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.3s ease;
}

.journey-node-progress-ring .progress-ring-check {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 32px;
    color: var(--color-mint-500);
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
    z-index: 5;
}

/* Base shadow ellipse */
.journey-node-shadow {
    position: absolute;
    bottom: -12px;
    width: 90px;
    height: 20px;
    background: radial-gradient(ellipse, rgba(0,0,0,0.15) 0%, transparent 70%);
    border-radius: 50%;
    z-index: 0;
}

/* The main sphere */
.journey-node-sphere {
    width: 70px;
    height: 70px;
    min-width: 70px;
    min-height: 70px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    z-index: 5;
    transition: all var(--transition-fast);
    aspect-ratio: 1;
    flex-shrink: 0;
}

.journey-node-sphere .material-symbols-rounded {
    font-size: 32px;
}

/* Node States */
.journey-node {
    cursor: pointer;
}

.journey-node:hover .journey-node-sphere {
    box-shadow: 
        0 6px 0 var(--twilight-600),
        0 12px 24px rgba(99, 102, 241, 0.4);
}

.journey-node.active .journey-node-sphere {
    background: var(--twilight-500);
    color: white;
    box-shadow: 
        0 6px 0 var(--twilight-600),
        0 8px 20px rgba(99, 102, 241, 0.3);
}

.journey-node.locked .journey-node-sphere {
    background: linear-gradient(180deg, #E5E7EB 0%, #D1D5DB 100%);
    color: #9CA3AF;
    box-shadow: 
        0 4px 0 #B0B5BD,
        0 6px 12px rgba(0, 0, 0, 0.1);
}

/* Progress ring is now shown on all nodes */

/* Base shadow ellipse */
.journey-node-shadow {
    position: absolute;
    bottom: -16px;
    width: 60px;
    height: 12px;
    background: radial-gradient(ellipse, rgba(0,0,0,0.12) 0%, transparent 70%);
    border-radius: 50%;
    z-index: 0;
}

/* Node Label - to the right of node */
.journey-node-label {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
    white-space: nowrap;
    padding: 8px 16px;
    background: var(--surface-base);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-sm);
    position: absolute;
    left: 100px;
    top: 10px;
    max-width: 250px;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.3;
    z-index: 10;
}

.journey-node.locked .journey-node-label {
    color: var(--text-muted);
    background: var(--color-gray-200);
}

/* Option D: Table */
body.option-d {
    background: var(--color-gray-200);
}

body.option-d .top-nav {
    background: var(--color-gray-200);
}

body.option-d .main-content {
    display: none;
}

body.option-d .table-layout {
    display: flex;
}

/* Option D transition to study mode */
body.option-d .table-layout.transitioning-out {
    animation: table-fade-out 0.35s ease-in forwards;
    pointer-events: none;
}

body.option-d .table-layout.transitioning-out .table-rail {
    animation: table-rail-exit 0.35s ease-in forwards;
}

body.option-d .table-layout.transitioning-out .table-main {
    animation: table-main-exit 0.35s ease-in forwards;
}

/* Option D transition back from study mode */
body.option-d .table-layout.transitioning-in {
    animation: table-fade-in 0.4s ease-out forwards;
}

body.option-d .table-layout.transitioning-in .table-rail {
    animation: table-rail-enter 0.4s ease-out forwards;
}

body.option-d .table-layout.transitioning-in .table-main {
    animation: table-main-enter 0.4s ease-out forwards;
}

@keyframes table-fade-out {
    from {
        opacity: 1;
    }
    to {
        opacity: 0;
    }
}

@keyframes table-fade-in {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes table-rail-exit {
    from {
        opacity: 1;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        transform: translateY(-20px);
    }
}

@keyframes table-main-exit {
    from {
        opacity: 1;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        transform: translateY(-20px);
    }
}

@keyframes table-rail-enter {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes table-main-enter {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Table Layout Container (matches study-mode-screen) */
.table-layout {
    display: none;
    flex-direction: row;
    height: calc(100vh - 64px);
    overflow: hidden;
    padding: 32px;
    gap: 32px;
}

/* Header inside table-main (matches study-mode-header) */
.table-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    position: absolute;
    top: 20px;
    left: 20px;
    right: 20px;
    z-index: 10;
}

.table-mode-control {
    display: flex;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    padding: 4px;
    height: 40px;
}

.table-mode-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 10px 16px;
    height: 32px;
    border-radius: var(--radius-full);
    font-size: var(--ref-typography-size-subheading-four);
    font-weight: var(--ref-typography-weight-subheader);
    line-height: var(--ref-typography-line-height-subheading-four);
    color: var(--color-gray-600);
    background: transparent;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.table-mode-btn:hover {
    color: var(--text-primary);
}

.table-mode-btn.active {
    background: var(--surface);
    color: var(--color-gray-600);
}

.table-mode-btn .material-symbols-rounded {
    font-size: 16px;
}

.table-header-actions {
    display: flex;
    gap: 8px;
}

.table-action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    background: var(--color-gray-200);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
    border: none;
    cursor: pointer;
}

.table-action-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.table-action-btn .material-symbols-rounded {
    font-size: 20px;
}

/* Main Section - Study Area (matches study-mode-main) */
.table-main {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-width: 0;
    overflow: hidden;
    background: var(--surface);
    border-radius: 32px;
    padding: 20px;
    position: relative;
}

/* Content Area below header */
.table-content-area {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
    overflow: hidden;
    margin-top: 60px; /* Space for absolute header */
}

/* Sort/Filter Buttons */
.table-sort-btn,
.table-filter-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 6px 12px;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.table-sort-btn:hover,
.table-filter-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.table-sort-btn .material-symbols-rounded,
.table-filter-btn .material-symbols-rounded {
    font-size: 18px;
}

/* List Toolbar */
.table-list-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-sm) var(--spacing-md);
    border-bottom: 1px solid var(--border-light);
    flex-shrink: 0;
}

.table-list-toolbar .toolbar-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.table-list-toolbar .toolbar-right {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.table-list-toolbar .table-search {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: 8px 14px;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    min-width: 200px;
}

.table-list-toolbar .table-search .material-symbols-rounded {
    color: var(--text-muted);
    font-size: 18px;
}

.table-list-toolbar .table-search input {
    border: none;
    outline: none;
    font-size: 14px;
    font-family: var(--font-family);
    color: var(--text-primary);
    background: transparent;
    flex: 1;
}

.table-list-toolbar .table-search input::placeholder {
    color: var(--text-muted);
}

.table-list-toolbar .toolbar-btn {
    padding: 6px 12px;
    font-size: 12px;
}

.table-list-toolbar .toolbar-btn.danger {
    color: var(--color-error);
}

.table-list-toolbar .toolbar-btn.danger:hover {
    background: rgba(239, 68, 68, 0.1);
}

/* Select All Checkbox */
.table-checkbox.select-all {
    display: flex;
    align-items: center;
    justify-content: center;
}

.table-terms-container {
    flex: 1;
    overflow-y: auto;
    padding: 0;
}

.table-terms-list {
    display: flex;
    flex-direction: column;
    width: 100%;
}

/* Term Row Styling */
.table-term-row {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-md);
    padding: var(--spacing-md);
    border-bottom: 1px solid var(--border-light);
    transition: background var(--transition-fast);
    cursor: pointer;
    width: 100%;
    box-sizing: border-box;
}

.table-term-row:last-child {
    border-bottom: none;
}

.table-term-row:hover {
    background: var(--color-gray-100);
}

.table-term-row.selected {
    background: var(--color-gray-100);
    border-radius: 16px;
}

/* Checkbox */
.table-term-checkbox {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    padding-top: 2px;
}

.table-checkbox {
    position: relative;
    display: inline-flex;
    cursor: pointer;
}

.table-checkbox input {
    position: absolute;
    opacity: 0;
    cursor: pointer;
    height: 0;
    width: 0;
}

.table-checkbox .custom-checkbox {
    width: 20px;
    height: 20px;
    background: var(--surface-base);
    border: 2px solid var(--color-gray-400);
    border-radius: var(--radius-sm);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-fast);
}

.table-checkbox input:checked + .custom-checkbox {
    background: var(--color-primary);
    border-color: var(--color-primary);
}

.table-checkbox input:checked + .custom-checkbox::after {
    content: '';
    color: white;
    font-size: 12px;
    font-weight: 700;
}

.table-checkbox:hover .custom-checkbox {
    border-color: var(--color-primary);
}

.table-term-audio {
    flex-shrink: 0;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.table-term-audio:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.table-term-audio .material-symbols-rounded {
    font-size: 18px;
}

.table-term-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
    min-width: 0;
}

.table-term-word {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
}

.table-term-def {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.5;
}

.table-term-star {
    flex-shrink: 0;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.table-term-star:hover {
    color: var(--color-sunset);
}

.table-term-star.starred {
    color: var(--color-sunset);
}

.table-term-star.starred .material-symbols-rounded {
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24 !important;
}

.table-term-star .material-symbols-rounded {
    font-size: 20px;
}

/* Table Term Actions (audio + star grouped on right) */
.table-term-actions {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-xs);
    flex-shrink: 0;
}

/* Table Term Progress Status (check/minus icons) */
.table-term-status {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    border-radius: var(--radius-md);
}

.table-term-status .material-symbols-rounded {
    font-size: 24px;
}

.table-term-status.known {
    color: var(--color-mint-500);
    background: var(--color-mint-100);
}

.table-term-status.known .material-symbols-rounded {
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
}

.table-term-status.learning {
    color: var(--color-gray-500);
    background: var(--color-gray-200);
}

/* Left Rail (matches study-mode-sidebar) */
.table-rail {
    width: 460px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: var(--surface);
    border-radius: 32px;
    padding: 24px;
}

.rail-content {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
    overflow-y: auto;
    flex: 1;
}

/* Rail Header */
.rail-header {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.rail-title {
    font-size: 26px;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
    line-height: 1.2;
}

.rail-meta {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.rail-meta-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
}

.rail-meta-item svg {
    flex-shrink: 0;
}

.rail-meta-item .material-symbols-rounded {
    font-size: 22px;
    color: var(--text-secondary);
}

.rail-meta-item .material-symbols-rounded.filled {
    color: var(--color-sunset);
}

/* Rail Progress View (shown when user has study progress) */
.rail-progress-view {
    display: none;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.rail-progress-bar {
    width: 100%;
    height: 4px;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    overflow: hidden;
}

.rail-progress-bar::before {
    content: '';
    display: block;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background: var(--color-gray-300);
}

.rail-progress-fill {
    height: 100%;
    background: var(--color-mint-500);
    border-radius: var(--radius-full);
    transition: width 0.3s ease;
    margin-top: -4px;
}

.rail-progress-text {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
}

/* Rail Primary Actions */
.rail-primary-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.rail-primary-actions .rail-action-btn {
    flex-shrink: 0;
}

.rail-study-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 14px 20px;
    background: var(--color-primary);
    color: white;
    border-radius: var(--radius-full);
    font-size: 15px;
    font-weight: 600;
    transition: all var(--transition-fast);
}

.rail-study-btn:hover {
    background: var(--color-primary-hover);
}

.rail-study-btn .material-symbols-rounded {
    font-size: 20px;
}

.rail-remix-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 14px 20px;
    background: var(--twilight-100);
    color: var(--twilight-500);
    border-radius: var(--radius-full);
    font-size: 15px;
    font-weight: 600;
    transition: all var(--transition-fast);
}

.rail-remix-btn:hover {
    background: var(--twilight-200);
}

.rail-remix-btn .material-symbols-rounded {
    font-size: 20px;
}

/* Rail Actions */
.rail-actions {
    display: flex;
    gap: var(--spacing-sm);
}

.rail-action-btn {
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.rail-action-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.rail-action-btn .material-symbols-rounded {
    font-size: 20px;
}

/* Rail Sections */
.rail-section {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.rail-section-title {
    font-size: 14px;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
}

.rail-about-text {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.6;
    margin: 0;
}

/* Rail Creator */
.rail-creator {
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-md);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--border-light);
}

.rail-creator-avatar {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-full);
    overflow: hidden;
    flex-shrink: 0;
}

.rail-creator-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.rail-creator-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.rail-creator-label {
    font-size: 12px;
    color: var(--text-muted);
}

.rail-creator-name {
    font-size: 15px;
    font-weight: 700;
    color: var(--text-primary);
}

.rail-creator-badge {
    font-size: 12px;
    color: var(--text-secondary);
}

/* Rail Course */
.rail-course {
    flex-direction: row;
    align-items: center;
    gap: var(--spacing-md);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--border-light);
}

.rail-course-icon {
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-gray-200);
    border-radius: var(--radius-lg);
    color: var(--text-secondary);
    flex-shrink: 0;
}

.rail-course-icon .material-symbols-rounded {
    font-size: 22px;
}

.rail-course-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.rail-course-title {
    font-size: 14px;
    font-weight: 700;
    color: var(--text-primary);
}

.rail-course-desc {
    font-size: 13px;
    color: var(--text-secondary);
}

/* Rail Similar Sets */
.rail-similar {
    gap: var(--spacing-md) !important;
}

.rail-filter-pills {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-xs);
}

.rail-pill {
    padding: 6px 14px;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.rail-pill:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.rail-pill.active {
    background: var(--color-primary);
    color: white;
}

.rail-recommendations {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.rail-rec-card {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    padding: var(--spacing-sm);
    background: var(--surface-base);
    border: 2px solid var(--border-default);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.rail-rec-card:hover {
    background: var(--color-gray-100);
    border-color: var(--color-gray-400);
}

.rail-rec-title {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 1.3;
}

.rail-rec-meta {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 12px;
    color: var(--text-secondary);
}

.rail-rec-meta-item {
    display: flex;
    align-items: center;
    gap: 4px;
}

.rail-rec-meta-item .material-symbols-rounded {
    font-size: 14px;
}

/* Expandable Search */
.expandable-search {
    display: flex;
    align-items: center;
    position: relative;
}

.search-toggle-btn {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.search-toggle-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.search-toggle-btn .material-symbols-rounded {
    font-size: 20px;
}

.search-input-wrapper {
    display: none;
    align-items: center;
    gap: var(--spacing-xs);
    padding: 8px 12px;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    min-width: 200px;
}

.expandable-search.expanded .search-toggle-btn {
    display: none;
}

.expandable-search.expanded .search-input-wrapper {
    display: flex;
}

.search-input-wrapper input {
    border: none;
    outline: none;
    background: transparent;
    font-size: 14px;
    font-family: var(--font-family);
    color: var(--text-primary);
    flex: 1;
    min-width: 0;
}

.search-input-wrapper input::placeholder {
    color: var(--text-muted);
}

.search-close-btn {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    border-radius: var(--radius-full);
    transition: all var(--transition-fast);
}

.search-close-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.search-close-btn .material-symbols-rounded {
    font-size: 18px;
}

/* Toolbar Icon Button */
.toolbar-icon-btn {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.toolbar-icon-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.toolbar-icon-btn .material-symbols-rounded {
    font-size: 20px;
}

/* Legacy toolbar styles - kept for compatibility */
.toolbar-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 14px;
    background: var(--color-gray-200);
    border: none;
    border-radius: var(--radius-full);
    font-size: 13px;
    font-weight: 600;
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.toolbar-btn:hover {
    background: var(--color-gray-300);
    color: var(--text-primary);
}

.toolbar-btn.primary {
    background: var(--color-primary);
    color: white;
}

.toolbar-btn.primary:hover {
    background: var(--color-primary-hover);
}

.toolbar-btn .material-symbols-rounded {
    font-size: 16px;
}

/* Table Styles - Excel-like grid */
.terms-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
}

.terms-table thead {
    position: sticky;
    top: 0;
    z-index: 10;
}

.terms-table th {
    padding: var(--spacing-sm) var(--spacing-md);
    text-align: left;
    font-size: 11px;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    background: var(--color-gray-200);
    border-bottom: 1px solid var(--border-default);
    border-right: 1px solid var(--border-default);
}

.terms-table th:last-child {
    border-right: none;
}

.terms-table th.col-checkbox {
    width: 50px;
    text-align: center;
}

.terms-table th.col-term {
    width: 40%;
}

.terms-table th.col-definition {
    width: auto;
}

.terms-table tbody tr {
    transition: background var(--transition-fast);
}

.terms-table tbody tr:hover {
    background: rgba(66, 85, 255, 0.04);
}

.terms-table tbody tr.selected {
    background: rgba(66, 85, 255, 0.1);
}

.terms-table td {
    padding: var(--spacing-sm) var(--spacing-md);
    vertical-align: middle;
    border-bottom: 1px solid var(--border-default);
    border-right: 1px solid var(--border-default);
}

.terms-table td:last-child {
    border-right: none;
}

.terms-table td.checkbox-cell {
    text-align: center;
    width: 50px;
}

/* Custom Checkbox - for legacy table view */
.custom-checkbox {
    width: 18px;
    height: 18px;
    border: 2px solid var(--color-gray-500);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-fast);
    background: var(--surface-base);
}

input:checked + .custom-checkbox {
    background: var(--color-primary);
    border-color: var(--color-primary);
}

input:checked + .custom-checkbox::after {
    content: '';
    color: white;
    font-size: 11px;
    font-weight: 700;
}

/* Term and Definition cells */
.term-cell {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 1.4;
}

.definition-cell {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.5;
}

/* Group Header Row */
.group-header-row td {
    background: var(--color-gray-200);
    padding: var(--spacing-sm) var(--spacing-md);
    border-bottom: 1px solid var(--border-default);
}

.group-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 13px;
    font-weight: 700;
    color: var(--text-primary);
    cursor: pointer;
}

.group-header .material-symbols-rounded {
    font-size: 20px;
    color: var(--text-muted);
    transition: transform 0.2s ease;
}

.group-header.collapsed .material-symbols-rounded {
    transform: rotate(-90deg);
}

.group-count {
    font-size: 11px;
    font-weight: 500;
    color: var(--text-muted);
    background: var(--surface-base);
    padding: 2px 8px;
    border-radius: var(--radius-full);
}

/* Selection Action Bar */
.table-action-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-sm) var(--spacing-xl);
    background: var(--color-gray-800);
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 100;
}

.table-action-bar.visible {
    transform: translateY(0);
}

.action-bar-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.selection-count {
    font-size: 14px;
    font-weight: 600;
    color: white;
}

.action-bar-clear {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-full);
    color: rgba(255, 255, 255, 0.6);
    transition: all var(--transition-fast);
}

.action-bar-clear:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.action-bar-clear .material-symbols-rounded {
    font-size: 18px;
}

.action-bar-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.action-bar-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 10px 18px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    font-size: 14px;
    font-weight: 600;
    color: white;
    transition: all var(--transition-fast);
}

.action-bar-btn:hover {
    background: rgba(255, 255, 255, 0.2);
}

.action-bar-btn.primary {
    background: var(--color-primary);
}

.action-bar-btn.primary:hover {
    background: var(--color-primary-hover);
}

.action-bar-btn.danger:hover {
    background: #EF4444;
}

.action-bar-btn .material-symbols-rounded {
    font-size: 18px;
}

/* Add padding to table content when action bar is visible */
.table-layout.has-selection .table-content {
    padding-bottom: 80px;
}

/* ============================================
   Option D: Mobile Responsive
   ============================================ */
@media (max-width: 1024px) {
    .table-top-bar {
        flex-wrap: wrap;
        gap: var(--spacing-md);
    }
    
    .table-title-section {
        min-width: auto;
        order: 1;
    }
    
    .table-segmented-control {
        order: 3;
    width: 100%;
        justify-content: center;
}

    .table-top-spacer {
        display: none;
}

    .segment-btn span:not(.material-symbols-rounded) {
    display: none;
}

    .segment-btn {
        padding: 10px 16px;
    }
    
    .toolbar-btn span:not(.material-symbols-rounded) {
    display: none;
}

    .toolbar-btn {
        padding: 8px 12px;
    }
}

@media (max-width: 768px) {
    .table-layout {
        padding: var(--spacing-xs);
        gap: var(--spacing-xs);
    }
    
    /* Top bar becomes stacked */
    .table-top-bar {
        flex-direction: column;
        align-items: stretch;
        padding: var(--spacing-md);
        gap: var(--spacing-sm);
    }
    
    .table-title-section {
        text-align: center;
    }
    
    .table-set-title {
        font-size: 20px;
    }
    
    .table-set-meta {
        justify-content: center;
        gap: var(--spacing-xs);
    }
    
    .table-meta-badge,
    .table-meta-item {
        font-size: 11px;
    }
    
    /* New mode control - scrollable on mobile */
    .table-mode-control {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        flex-wrap: wrap;
        height: auto;
    }
    
    .table-mode-control::-webkit-scrollbar {
        display: none;
    }
    
    .table-mode-btn {
        flex-shrink: 0;
    }
    
    .table-mode-btn span:last-child {
        display: none;
    }
    
    /* Two column becomes stacked */
    .table-layout {
        flex-direction: column;
        gap: var(--spacing-md);
        padding: var(--spacing-md);
    }
    
    .table-rail {
        width: 100%;
        max-height: 35vh;
    }
    
    .table-main {
        padding: 16px;
    }
    
    .table-header {
        position: relative;
        top: auto;
        left: auto;
        right: auto;
        margin-bottom: var(--spacing-md);
    }
    
    .table-content-area {
        margin-top: 0;
    }
    
    .rail-title {
        font-size: 22px;
    }
    
    .table-list-toolbar {
        flex-direction: column;
        gap: var(--spacing-sm);
        align-items: stretch;
    }
    
    .table-list-toolbar .toolbar-left,
    .table-list-toolbar .toolbar-right {
        justify-content: center;
    }
    
    .table-list-toolbar .table-search {
        min-width: auto;
        flex: 1;
    }
    
    /* Segmented control scrollable (legacy) */
    .table-segmented-control {
        overflow-x: auto;
        justify-content: flex-start;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
    }
    
    .table-segmented-control::-webkit-scrollbar {
        display: none;
    }

    .segment-btn {
        flex-shrink: 0;
        padding: 8px 12px;
    }
    
    /* Toolbar stacks */
    .table-toolbar {
        flex-direction: column;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm);
        border-radius: var(--radius-lg);
    }
    
    .table-toolbar-left,
    .table-toolbar-center,
    .table-toolbar-right {
        width: 100%;
        justify-content: center;
    }
    
    .table-search {
        min-width: auto;
        flex: 1;
    }
    
    .table-toolbar-right {
        flex-wrap: wrap;
        gap: var(--spacing-xs);
    }
    
    .toolbar-btn {
        flex: 1;
        min-width: calc(50% - 4px);
        justify-content: center;
        padding: 10px 8px;
        font-size: 12px;
    }
    
    .toolbar-btn span:not(.material-symbols-rounded) {
        display: inline;
        font-size: 11px;
    }
    
    .toolbar-btn .material-symbols-rounded {
        font-size: 16px;
    }
    
    /* Table optimized for mobile */
    .table-content {
        border-radius: var(--radius-lg);
    }
    
    .terms-table {
        table-layout: auto;
    }
    
    .terms-table th,
    .terms-table td {
        padding: var(--spacing-xs) var(--spacing-sm);
    }
    
    .terms-table th.col-checkbox,
    .terms-table td.checkbox-cell {
        width: 40px;
    }
    
    .term-cell {
        font-size: 13px;
    }
    
    .definition-cell {
        font-size: 12px;
    }
    
    /* Action bar mobile */
    .table-action-bar {
        flex-direction: column;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm);
    }
    
    .action-bar-left {
        justify-content: center;
    }
    
    .action-bar-actions {
        flex-wrap: wrap;
        justify-content: center;
        gap: var(--spacing-xs);
    }
    
    .action-bar-btn {
        padding: 8px 12px;
        font-size: 12px;
    }
    
    .action-bar-btn span:not(.material-symbols-rounded) {
    display: none;
    }
}

@media (max-width: 480px) {
    .table-layout {
        padding: 0;
        gap: 0;
    }
    
    .table-top-bar {
        border-radius: 0;
        padding: var(--spacing-sm);
    }
    
    .table-set-title {
        font-size: 18px;
    }
    
    .table-meta-badge {
        padding: 2px 6px;
        font-size: 10px;
    }
    
    .table-meta-badge .material-symbols-rounded {
        font-size: 12px;
    }
    
    .segment-btn {
        padding: 8px 10px;
    }
    
    .segment-btn .material-symbols-rounded {
        font-size: 18px;
    }
    
    .table-toolbar {
        border-radius: 0;
        padding: var(--spacing-xs);
    }
    
    .table-content {
        border-radius: 0;
    }
    
    /* Card-style rows for very small screens */
    .terms-table thead {
        display: none;
    }
    
    .terms-table,
    .terms-table tbody,
    .terms-table tr,
    .terms-table td {
        display: block;
        width: 100%;
    }
    
    .terms-table tr {
        padding: var(--spacing-sm);
        border-bottom: 1px solid var(--border-default);
        position: relative;
    }
    
    .terms-table tr.selected {
        background: rgba(66, 85, 255, 0.1);
    }
    
    .terms-table td {
        border: none;
        padding: 0;
    }
    
    .terms-table td.checkbox-cell {
        position: absolute;
        top: var(--spacing-sm);
        left: var(--spacing-sm);
        width: auto;
    }
    
    .term-cell {
        padding-left: 36px;
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 4px;
    }
    
    .definition-cell {
        padding-left: 36px;
        font-size: 13px;
        color: var(--text-secondary);
    }
    
    /* Group headers on mobile */
    .group-header-row td {
        padding: var(--spacing-sm);
    }
    
    .group-header {
        font-size: 12px;
    }
    
    /* Action bar fully bottom fixed */
    .table-action-bar {
        border-radius: 0;
    }
    
    .action-bar-btn {
        padding: 10px;
    }
    
    .action-bar-btn .material-symbols-rounded {
        font-size: 20px;
    }
}

/* ============================================
   Study Mode Screen Styles
   ============================================ */

.study-mode-screen {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--color-gray-200);
    z-index: 2000;
    font-family: var(--font-family);
    padding: 32px;
    gap: 32px;
    opacity: 0;
}

.study-mode-screen.active {
    display: flex;
    animation: study-mode-fade-in 0.4s ease-out forwards;
}

.study-mode-screen.closing {
    display: flex;
    animation: study-mode-fade-out 0.3s ease-in forwards;
}

@keyframes study-mode-fade-in {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes study-mode-fade-out {
    from {
        opacity: 1;
    }
    to {
        opacity: 0;
    }
}

/* Study mode sidebar entrance animation */
.study-mode-screen.active .study-mode-sidebar {
    animation: study-slide-in-up 0.45s ease-out forwards;
}

/* Study mode main entrance animation */
.study-mode-screen.active .study-mode-main {
    opacity: 0;
    animation: study-slide-in-up 0.45s ease-out forwards;
    animation-delay: 0.08s;
}

@keyframes study-slide-in-up {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Left Sidebar - Progress View */
.study-mode-sidebar {
    width: 342px;
    background: var(--surface);
    border-radius: 32px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    padding: 24px;
    flex-shrink: 0;
}

.study-mode-sidebar-header {
    margin-bottom: 32px;
}

.study-mode-title-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 16px;
}

.study-mode-title {
    font-size: 24px;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 32px;
}

.study-mode-title-dropdown {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    padding: 4px;
    background: var(--color-gray-200);
    border: none;
    border-radius: var(--radius-full);
    color: var(--color-gray-600);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.study-mode-title-dropdown:hover {
    background: var(--color-gray-300);
}

.study-mode-title-dropdown .material-symbols-rounded {
    font-size: 16px;
    transition: transform var(--transition-fast);
}

.study-mode-title-dropdown.open .material-symbols-rounded {
    transform: rotate(180deg);
}

/* Group Selection Dropdown */
.study-mode-group-dropdown {
    display: none;
    position: absolute;
    top: calc(100% + 8px);
    left: 0;
    right: 0;
    background: var(--surface);
    border-radius: var(--radius-lg);
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.12);
    z-index: 100;
    max-height: 320px;
    overflow-y: auto;
    padding: 8px;
}

.study-mode-group-dropdown.open {
    display: block;
}

.study-mode-group-dropdown-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: background var(--transition-fast);
    font-size: var(--ref-typography-size-subheading-four);
    font-weight: 600;
}

.study-mode-group-dropdown-item:hover {
    background: var(--color-gray-200);
}

/* Checkbox Styles */
.study-mode-group-checkbox {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.study-mode-group-checkbox input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    width: 100%;
    height: 100%;
    cursor: pointer;
    margin: 0;
}

.study-mode-checkbox-mark {
    width: 20px;
    height: 20px;
    border: 2px solid var(--color-gray-400);
    border-radius: var(--radius-sm);
    background: var(--surface);
    transition: all var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
}

.study-mode-checkbox-mark::after {
    content: '';
    display: none;
    width: 5px;
    height: 9px;
    border: solid white;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
    margin-bottom: 2px;
}

.study-mode-group-checkbox input[type="checkbox"]:checked + .study-mode-checkbox-mark {
    background: var(--twilight-500);
    border-color: var(--twilight-500);
}

.study-mode-group-checkbox input[type="checkbox"]:checked + .study-mode-checkbox-mark::after {
    display: block;
}

.study-mode-group-checkbox input[type="checkbox"]:indeterminate + .study-mode-checkbox-mark {
    background: var(--twilight-500);
    border-color: var(--twilight-500);
}

.study-mode-group-checkbox input[type="checkbox"]:indeterminate + .study-mode-checkbox-mark::after {
    display: block;
    width: 10px;
    height: 2px;
    border: none;
    background: white;
    transform: none;
    margin: 0;
}

.study-mode-group-dropdown-item:hover .study-mode-checkbox-mark {
    border-color: var(--twilight-400);
}

.study-mode-group-name {
    flex: 1;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
}

.study-mode-group-count {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-tertiary);
    background: var(--color-gray-200);
    padding: 2px 8px;
    border-radius: var(--radius-full);
}

.study-mode-group-dropdown-divider {
    height: 1px;
    background: var(--border-default);
    margin: 8px 0;
}

.study-mode-group-dropdown-list {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.study-mode-group-dropdown-empty {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 16px;
    color: var(--text-tertiary);
    font-size: 13px;
}

.study-mode-group-dropdown-empty .material-symbols-rounded {
    font-size: 18px;
}

.study-mode-title-row {
    position: relative;
}

.study-mode-progress {
    margin-bottom: 8px;
}

.study-mode-progress-bar {
    width: 100%;
    height: 4px;
    background: var(--color-mint-100);
    border-radius: var(--radius-full);
    overflow: visible;
    position: relative;
}

.study-mode-progress-fill {
    height: 100%;
    background: var(--color-mint-500);
    border-radius: var(--radius-full);
    transition: width 0.3s ease;
    position: relative;
    min-width: 4px;
}

/* Placeholder circle at end of progress fill */
.study-mode-progress-fill::after {
    content: '';
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    height: 4px;
    background: var(--color-mint-500);
    border-radius: 50%;
}

.study-mode-progress-text {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 20px;
}

/* Filter Pills */
.study-mode-filters {
    display: flex;
    gap: 8px;
    margin-bottom: 24px;
    flex-wrap: wrap;
}

.study-mode-filter-pill {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 6px 12px;
    background: var(--color-gray-200);
    border: 2px solid transparent;
    border-radius: var(--radius-full);
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    color: var(--color-gray-600);
    cursor: pointer;
    transition: all var(--transition-fast);
    line-height: 20px;
}

.study-mode-filter-pill:hover {
    background: var(--color-gray-300);
}

.study-mode-filter-pill.active {
    background: var(--color-gray-200);
    border-color: var(--color-gray-600);
}

.study-mode-filter-star {
    padding: 8px;
}

.study-mode-filter-star .material-symbols-rounded {
    font-size: 16px;
}

/* Concepts Progress List */
.study-mode-concepts-list {
    flex: 1;
    overflow-y: auto;
    overflow-x: visible;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    padding: 0 var(--spacing-sm);
    margin: 0 calc(var(--spacing-sm) * -1);
}

.study-mode-concept-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-sm);
    cursor: pointer;
    border-radius: var(--radius-full);
    transition: background var(--transition-fast);
    border-radius: var(--radius-md);
    user-select: none;
    -webkit-user-select: none;
    outline: none;
    -webkit-tap-highlight-color: transparent;
}

.study-mode-concept-item:hover {
    background: var(--color-gray-100);
}

.study-mode-concept-item.active {
    background: var(--color-gray-200);
}

.study-mode-concept-ring {
    width: 32px;
    height: 32px;
    flex-shrink: 0;
    position: relative;
}

.study-mode-concept-ring svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.study-mode-concept-ring .progress-ring-bg {
    fill: none;
    stroke: var(--color-gray-300);
    stroke-width: 3;
}

.study-mode-concept-ring .progress-ring-fill {
    fill: none;
    stroke: var(--color-mint-500);
    stroke-width: 3;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.3s ease;
}

/* Check icon when concept is complete */
.study-mode-concept-ring .concept-complete-check {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    color: var(--color-mint-500);
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
}

.study-mode-concept-info {
    flex: 1;
    min-width: 0;
}

.study-mode-concept-title {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 20px;
    margin-bottom: 2px;
}

.study-mode-concept-count {
    font-size: var(--ref-typography-size-subheading-four);
    font-weight: var(--ref-typography-weight-subheader);
    color: var(--text-secondary);
    line-height: 18px;
}

/* Legacy Terms List - hidden but kept for backwards compat */
.study-mode-terms-list {
    display: none;
    flex: 1;
    overflow-y: auto;
    flex-direction: column;
    gap: 16px;
}

.study-mode-term-item {
    display: flex;
    align-items: center;
    gap: 4px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border-default);
    cursor: pointer;
    transition: background var(--transition-fast);
}

.study-mode-term-item:last-child {
    border-bottom: none;
}

.study-mode-term-content {
    flex: 1;
    min-width: 0;
}

.study-mode-term-text {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 20px;
    margin-bottom: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.study-mode-term-def {
    font-size: 14px;
    font-weight: 400;
    color: var(--text-secondary);
    line-height: 20px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.study-mode-term-status {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    flex-shrink: 0;
}

.study-mode-term-status.known {
    background: var(--color-mint-100);
}

.study-mode-term-status.known .material-symbols-rounded {
    color: var(--color-mint-500);
    font-variation-settings: 
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
}

.study-mode-term-status.unknown {
    background: var(--color-gray-200);
}

.study-mode-term-status.unknown .material-symbols-rounded {
    color: var(--color-gray-400);
}

.study-mode-term-status .material-symbols-rounded {
    font-size: 24px;
}

/* Right Panel - Study Area */
.study-mode-main {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: var(--surface);
    border-radius: 32px;
    padding: 20px;
    position: relative;
    overflow: hidden;
}

/* Mode Tabs Header */
.study-mode-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    position: absolute;
    top: 20px;
    left: 20px;
    right: 20px;
    z-index: 10;
}

.study-mode-tabs-container {
    display: flex;
    background: var(--color-gray-200);
    border-radius: var(--radius-full);
    padding: 4px;
    height: 40px;
}

.study-mode-tab {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 10px 16px;
    height: 32px;
    background: transparent;
    border: none;
    border-radius: var(--radius-full);
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    color: var(--color-gray-600);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.study-mode-tab:hover {
    color: var(--text-primary);
}

.study-mode-tab.active {
    background: var(--surface);
    color: var(--color-gray-600);
}

.study-mode-tab .material-symbols-rounded {
    font-size: 16px;
}

/* Completed tab state */
.study-mode-tab.completed {
    color: var(--text-secondary);
}

.study-mode-tab.completed::after {
    content: 'check';
    font-family: 'Material Symbols Rounded';
    font-size: 14px;
    color: var(--text-secondary);
    margin-left: 2px;
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24;
}

/* Next tab state - subtle indication to encourage progression */
.study-mode-tab.next {
    position: relative;
    color: var(--twilight-500);
}

.study-mode-header-actions {
    display: flex;
    gap: 8px;
}

.study-mode-action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--color-gray-200);
    border: none;
    border-radius: var(--radius-full);
    color: var(--color-gray-600);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.study-mode-action-btn:hover {
    background: var(--color-gray-300);
}

.study-mode-action-btn .material-symbols-rounded {
    font-size: 24px;
}

/* Flashcard Container */
.study-mode-card-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 60px 98px 48px;
    gap: 24px;
}

.study-mode-card-stack {
    position: relative;
    width: 100%;
    max-width: 732px;
}

.study-mode-card-bg {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 100%;
    background: var(--surface);
    border: 1px solid var(--color-gray-200);
    border-radius: 42px;
    box-shadow: 0 4px 32px rgba(40, 46, 62, 0.1);
    transform: rotate(2deg);
    transform-origin: center center;
}

.study-mode-card {
    position: relative;
    width: 100%;
    aspect-ratio: 732 / 480;
    perspective: 1000px;
    cursor: pointer;
    z-index: 1;
}

.study-mode-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    transform-style: preserve-3d;
}

.study-mode-card.flipped .study-mode-card-inner {
    transform: rotateX(180deg);
}

.study-mode-card-front,
.study-mode-card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    background: var(--surface);
    border: 1px solid var(--color-gray-200);
    border-radius: 42px;
    box-shadow: 0 4px 32px rgba(40, 46, 62, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 42px;
}

.study-mode-card-back {
    transform: rotateX(180deg);
}

.study-mode-card-content {
    font-size: 20px;
    font-weight: 600;
    color: var(--text-primary);
    text-align: center;
    line-height: 28px;
    max-width: 812px;
}

.study-mode-card-audio,
.study-mode-card-star {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: transparent;
    border: none;
    border-radius: var(--radius-full);
    color: var(--color-gray-600);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.study-mode-card-audio {
    top: 23px;
    left: 23px;
}

.study-mode-card-star {
    top: 23px;
    right: 23px;
}

.study-mode-card-audio:hover,
.study-mode-card-star:hover {
    background: var(--color-gray-200);
}

.study-mode-card-star.starred {
    color: var(--color-sunset);
}

.study-mode-card-star.starred .material-symbols-rounded {
    font-variation-settings:
        'FILL' 1,
        'wght' 400,
        'GRAD' -25,
        'opsz' 24 !important;
}

.study-mode-card-audio .material-symbols-rounded,
.study-mode-card-star .material-symbols-rounded {
    font-size: 24px;
}

/* Card Controls */
.study-mode-card-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    max-width: 732px;
}

.study-mode-control-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 56px;
    height: 40px;
    background: var(--color-gray-200);
    border: none;
    border-radius: var(--radius-full);
    color: var(--color-gray-600);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.study-mode-control-btn:hover {
    background: var(--color-gray-300);
}

.study-mode-control-btn .material-symbols-rounded {
    font-size: 24px;
}

.study-mode-nav-controls {
    display: flex;
    align-items: center;
    gap: 24px;
}

.study-mode-nav-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 56px;
    height: 40px;
    background: var(--color-gray-200);
    border: none;
    border-radius: var(--radius-full);
    color: var(--color-gray-600);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.study-mode-nav-btn:hover {
    background: var(--color-gray-300);
}

.study-mode-nav-btn .material-symbols-rounded {
    font-size: 24px;
}

.study-mode-counter {
    font-size: 14px;
    font-weight: 600;
    color: var(--color-gray-600);
    line-height: 20px;
    padding: 10px 16px;
}

/* Responsive */
@media (max-width: 1200px) {
    .study-mode-screen {
        padding: 24px;
        gap: 24px;
    }
    
    .study-mode-card-container {
        padding: 60px 40px 32px;
    }
}

@media (max-width: 900px) {
    .study-mode-screen {
        padding: 16px;
        gap: 16px;
    }
    
    .study-mode-sidebar {
        width: 280px;
        padding: 16px;
        border-radius: 24px;
    }
    
    .study-mode-main {
        border-radius: 24px;
    }
    
    .study-mode-title {
        font-size: 20px;
    }
    
    .study-mode-card-content {
        font-size: 18px;
    }
    
    .study-mode-card-front,
    .study-mode-card-back,
    .study-mode-card-bg {
        border-radius: 24px;
    }
}

@media (max-width: 768px) {
    .study-mode-screen.active {
        flex-direction: column;
    }
    
    .study-mode-sidebar {
        width: 100%;
        height: auto;
        max-height: 35vh;
    }
    
    .study-mode-main {
        padding: 16px;
    }
    
    .study-mode-card-container {
        padding: 40px 20px 24px;
    }
    
    .study-mode-tabs-container {
        flex-wrap: wrap;
        height: auto;
    }
    
    .study-mode-tab span:last-child {
        display: none;
    }
    
    .study-mode-card {
        max-width: 100%;
    }
    
    .study-mode-card-content {
        font-size: 16px;
    }
    
    .study-mode-filters {
        flex-wrap: nowrap;
        overflow-x: auto;
    }
}

/* ============================================
   Create Set Screen Styles
   ============================================ */

.create-set-screen {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--color-gray-200);
    z-index: 2000;
    overflow: hidden;
    font-family: var(--font-family);
}

.create-set-screen.active {
    display: flex;
    flex-direction: column;
}

/* Create Header */
.create-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 24px;
    background: var(--surface);
    border-bottom: 1px solid var(--border-default);
    flex-shrink: 0;
}

/* Create Set Layout */
.create-set-layout {
    display: flex;
    flex: 1;
    overflow: hidden;
}

/* Main Content Area */
.create-set-main {
    flex: 1;
    padding: 32px 48px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* Title Row */
.create-title-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    max-width: 900px;
    margin-bottom: 16px;
}

.create-page-title {
    font-size: 24px;
    font-weight: 700;
    color: var(--text-primary);
}

.create-title-actions {
    display: flex;
    gap: 12px;
}

.create-action-btn-secondary {
    padding: 12px 24px;
    background: transparent;
    color: var(--color-primary);
    border: 2px solid var(--color-primary);
    border-radius: var(--radius-full);
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.create-action-btn-secondary:hover {
    background: var(--twilight-100);
}

.create-action-btn-primary {
    padding: 12px 24px;
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: var(--radius-full);
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.create-action-btn-primary:hover {
    background: var(--color-primary-hover);
}

/* Visibility Badge */
.create-visibility {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: var(--surface);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-full);
    font-size: 13px;
    color: var(--text-secondary);
    width: 100%;
    max-width: 900px;
    width: fit-content;
    align-self: flex-start;
    margin-left: calc((100% - 900px) / 2);
    margin-bottom: 24px;
}

.create-visibility .material-symbols-rounded {
    font-size: 16px;
}

/* Set Info Card */
.create-set-info {
    width: 100%;
    max-width: 900px;
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: var(--shadow-sm);
}

.create-set-title-input {
    width: 100%;
    border: none;
    font-family: inherit;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-primary);
    padding: 8px 0;
    background: transparent;
    border-bottom: 2px solid var(--border-default);
    transition: border-color var(--transition-fast);
}

.create-set-title-input:focus {
    outline: none;
    border-bottom-color: var(--color-primary);
}

.create-set-title-input::placeholder {
    color: var(--text-tertiary);
}

.create-set-description {
    width: 100%;
    border: none;
    font-family: inherit;
    font-size: 14px;
    color: var(--text-secondary);
    padding: 16px 0 8px;
    background: transparent;
    resize: none;
    min-height: 40px;
}

.create-set-description:focus {
    outline: none;
}

.create-set-description::placeholder {
    color: var(--text-tertiary);
}

/* Toolbar */
.create-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    max-width: 900px;
    margin-bottom: 16px;
}

.create-toolbar-left,
.create-toolbar-right {
    display: flex;
    align-items: center;
    gap: 12px;
}

.create-tool-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 10px 16px;
    background: var(--surface);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-full);
    font-family: inherit;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-primary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.create-tool-btn:hover {
    background: var(--color-gray-200);
}

.create-tool-btn .material-symbols-rounded {
    font-size: 18px;
}

.create-tool-btn-locked {
    position: relative;
}

.create-lock-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 22px;
    height: 22px;
    background: var(--ref-color-sunset-300);
    border-radius: 50%;
    margin-left: 4px;
}

.create-lock-icon .material-symbols-rounded {
    font-size: 14px;
    color: var(--ref-color-sunset-500);
}

/* Toggle */
.create-toggle-label {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
    color: var(--text-secondary);
    cursor: pointer;
}

.create-toggle {
    position: relative;
    width: 44px;
    height: 24px;
}

.create-toggle input {
    opacity: 0;
    width: 0;
    height: 0;
}

.create-toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--color-gray-400);
    transition: 0.3s;
    border-radius: 24px;
}

.create-toggle-slider::before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: 0.3s;
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.create-toggle input:checked + .create-toggle-slider {
    background-color: var(--color-primary);
}

.create-toggle input:checked + .create-toggle-slider::before {
    transform: translateX(20px);
}

/* Icon Buttons */
.create-icon-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: transparent;
    border: none;
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.create-icon-btn:hover {
    background: var(--color-gray-300);
}

.create-icon-btn .material-symbols-rounded {
    font-size: 22px;
}

/* Cards List */
.create-cards-list {
    width: 100%;
    max-width: 900px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

/* Card */
.create-card {
    background: var(--surface);
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
}

.create-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 20px;
    border-bottom: 1px solid var(--border-default);
}

.create-card-number {
    font-size: 14px;
    font-weight: 700;
    color: var(--text-primary);
}

.create-card-actions {
    display: flex;
    gap: 4px;
}

.create-card-action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    background: transparent;
    border: none;
    border-radius: var(--radius-sm);
    color: var(--text-tertiary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.create-card-action-btn:hover {
    background: var(--color-gray-200);
    color: var(--text-secondary);
}

.create-card-content {
    display: flex;
    gap: 24px;
    padding: 20px;
}

.create-card-field {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.create-card-input {
    width: 100%;
    border: none;
    border-bottom: 2px solid var(--border-default);
    padding: 8px 0;
    font-family: inherit;
    font-size: 15px;
    color: var(--text-primary);
    background: transparent;
    transition: border-color var(--transition-fast);
}

.create-card-input:focus {
    outline: none;
    border-bottom-color: var(--color-primary);
}

.create-card-input::placeholder {
    color: var(--text-tertiary);
}

.create-card-label {
    font-size: 11px;
    font-weight: 700;
    color: var(--text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-top: 8px;
}

.create-card-image {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 80px;
    height: 80px;
    border: 2px dashed var(--color-gray-400);
    border-radius: var(--radius-md);
    color: var(--text-tertiary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.create-card-image:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

.create-card-image .material-symbols-rounded {
    font-size: 24px;
    margin-bottom: 4px;
}

.create-card-image span:last-child {
    font-size: 11px;
    font-weight: 500;
}

/* Add Card Button */
.create-add-card-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    max-width: 900px;
    padding: 20px;
    margin-top: 16px;
    background: var(--surface);
    border: 2px solid var(--border-default);
    border-radius: var(--radius-lg);
    font-family: inherit;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.create-add-card-btn:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
    background: var(--twilight-100);
}

/* Smart Assist Sidebar */
.create-smart-assist {
    width: 280px;
    background: var(--surface);
    border-left: 1px solid var(--border-default);
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
}

.smart-assist-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 20px;
    border-bottom: 1px solid var(--border-default);
}

.smart-assist-title {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
}

.smart-assist-icon {
    font-size: 20px;
    color: var(--color-primary);
}

.smart-assist-title > span:nth-child(2) {
    font-size: 16px;
    font-weight: 600;
    color: var(--color-primary);
}

.smart-assist-badge {
    padding: 2px 8px;
    background: var(--ref-color-skyblue-100);
    color: var(--ref-color-skyblue-500);
    border-radius: var(--radius-full);
    font-size: 11px;
    font-weight: 600;
}

.smart-assist-close {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    background: transparent;
    border: none;
    border-radius: var(--radius-sm);
    color: var(--text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.smart-assist-close:hover {
    background: var(--color-gray-200);
}

.smart-assist-body {
    flex: 1;
    padding: 20px;
}

.smart-assist-description {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.5;
}

.smart-assist-footer {
    padding: 20px;
    border-top: 1px solid var(--border-default);
}

.smart-assist-count {
    display: block;
    text-align: right;
    font-size: 12px;
    color: var(--text-tertiary);
    margin-bottom: 16px;
}

.smart-assist-actions {
    display: flex;
    gap: 12px;
    margin-bottom: 16px;
}

.smart-assist-upload-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 12px 20px;
    background: transparent;
    border: 2px solid var(--color-primary);
    color: var(--color-primary);
    border-radius: var(--radius-full);
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.smart-assist-upload-btn:hover {
    background: var(--twilight-100);
}

.smart-assist-upload-btn .material-symbols-rounded {
    font-size: 18px;
}

.smart-assist-start-btn {
    flex: 1;
    padding: 12px 20px;
    background: var(--color-gray-300);
    border: none;
    color: var(--text-tertiary);
    border-radius: var(--radius-full);
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    cursor: not-allowed;
    transition: all var(--transition-fast);
}

.smart-assist-start-btn:not(:disabled) {
    background: var(--color-primary);
    color: white;
    cursor: pointer;
}

.smart-assist-start-btn:not(:disabled):hover {
    background: var(--color-primary-hover);
}

.smart-assist-powered {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    font-size: 12px;
    color: var(--text-tertiary);
}

.smart-assist-powered .material-symbols-rounded {
    font-size: 16px;
}

/* Back Button */
.create-back-btn {
    position: fixed;
    top: 80px;
    left: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    background: var(--surface);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-full);
    color: var(--text-secondary);
    cursor: pointer;
    box-shadow: var(--shadow-md);
    transition: all var(--transition-fast);
    z-index: 10;
}

.create-back-btn:hover {
    background: var(--color-gray-200);
    transform: scale(1.05);
}

.create-back-btn .material-symbols-rounded {
    font-size: 22px;
}

/* Responsive */
@media (max-width: 900px) {
    .create-set-main {
        padding: 24px;
    }
    
    .create-visibility {
        margin-left: 0;
        align-self: flex-start;
    }
    
    .create-title-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
    }
    
    .create-toolbar {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
    }
    
    .create-card-content {
        flex-direction: column;
    }
    
    .create-card-image {
        width: 100%;
        height: 60px;
        flex-direction: row;
        gap: 8px;
    }
    
    .create-card-image .material-symbols-rounded {
        margin-bottom: 0;
    }
}

@media (max-width: 768px) {
    .create-smart-assist {
        display: none;
    }
    
    .create-header {
        padding: 12px 16px;
    }
    
}
